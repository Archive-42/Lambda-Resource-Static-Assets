<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README.ko</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="브라우저-확장-프로젝트-파트-2-로컬-저장소를-사용한-api-호출">브라우저 확장 프로젝트 파트 2: 로컬 저장소를 사용한, API 호출</h1>
<h2 id="강의-전-퀴즈">강의 전 퀴즈</h2>
<p>[Pre-lecture quiz][Pre-lecture quiz](https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/25?loc=ko)</p>
<h3 id="소개">소개</h3>
<p>이 강의에서는, 브라우저 확장의 폼을 제출하여 API를 호출하고 브라우저 확장에 결과를 출력합니다. 또한, 나중에 참조하고 사용하도록 브라우저의 로컬 저장소에 데이터를 저장하는 방법에 대해 알아봅니다.</p>
<p>✅ 적절한 파일 번호가 매겨진 세그먼트를 따라서 코드를 둘 위치를 알아봅니다.</p>
<h3 id="확장에서-조작할-요소를-설정합니다">확장에서 조작할 요소를 설정합니다:</h3>
<p>지금까지 HTML 폼과 브라우저 확장에 대한 결과 <code>&lt;div&gt;</code>를 작성했습니다. 이제부터, <code>/src/index.js</code> 파일에서 작업하고 확장을 조금씩 빌드해야 합니다. 프로젝트 설정 및 빌드 프로세스에 대해서는 <a href="../../1-about-browsers/translations/README.ko.md">이전 강의</a>를 참조하세요.</p>
<p><code>index.js</code> 파일에서 작업하면서, 다양한 필드에 값을 저장할 <code>const</code> 변수를 만드는 것으로 시작합니다:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="co">// form fields</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">const</span> form <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.form-data&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">const</span> region <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.region-name&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">const</span> apiKey <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.api-key&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">// results</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">const</span> errors <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.errors&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">const</span> loading <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.loading&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">const</span> results <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.result-container&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">const</span> usage <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.carbon-usage&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">const</span> fossilfuel <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.fossil-fuel&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">const</span> myregion <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.my-region&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">const</span> clearBtn <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.clear-btn&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>모든 필드는 이전 강의에서 HTML을 설정한 것처럼 CSS 클래스에서 참조됩니다.</p>
<h3 id="리스너-추가하기">리스너 추가하기</h3>
<p>다음으로, 폼에 이벤트 리스너를 추가하고 폼을 리셋해주는 clear 버튼을 추가하여, 폼을 제출하거나 reset 버튼을 클릭하면 실행되도록, 파일 하단에 앱 초기화를 호출하도록 추가합니다:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="va">form</span>.<span class="at">addEventListener</span>(<span class="st">&#39;submit&#39;</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> <span class="at">handleSubmit</span>(e))<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="va">clearBtn</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> <span class="at">reset</span>(e))<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="at">init</span>()<span class="op">;</span></a></code></pre></div>
<p>✅ submit 또는 click 이벤트를 받을 때 사용되는 약칭과, 이벤트가 handleSubmit 또는 reset 함수에 전달되는 방법에 유의하십시오. 이 약칭에 관련된 것을 더 긴 형식으로 바꿔 작성할 수 있나요? 어느 쪽을 선호하나요?</p>
<h3 id="init-함수와-reset-함수-작성하기">init() 함수와 reset() 함수 작성하기:</h3>
<p>이제 init()라고 불리는 확장 초기화하는 함수를 만드려고 합니다:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">function</span> <span class="at">init</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">    <span class="co">//if anything is in localStorage, pick it up</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="kw">const</span> storedApiKey <span class="op">=</span> <span class="va">localStorage</span>.<span class="at">getItem</span>(<span class="st">&#39;apiKey&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">const</span> storedRegion <span class="op">=</span> <span class="va">localStorage</span>.<span class="at">getItem</span>(<span class="st">&#39;regionName&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="co">//set icon to be generic green</span></a>
<a class="sourceLine" id="cb3-7" title="7">    <span class="co">//todo</span></a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="cf">if</span> (storedApiKey <span class="op">===</span> <span class="kw">null</span> <span class="op">||</span> storedRegion <span class="op">===</span> <span class="kw">null</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-10" title="10">        <span class="co">//if we don&#39;t have the keys, show the form</span></a>
<a class="sourceLine" id="cb3-11" title="11">        <span class="va">form</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-12" title="12">        <span class="va">results</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-13" title="13">        <span class="va">loading</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-14" title="14">        <span class="va">clearBtn</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-15" title="15">        <span class="va">errors</span>.<span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-16" title="16">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-17" title="17">        <span class="co">//if we have saved keys/regions in localStorage, show results when they load</span></a>
<a class="sourceLine" id="cb3-18" title="18">        <span class="at">displayCarbonUsage</span>(storedApiKey<span class="op">,</span> storedRegion)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-19" title="19">        <span class="va">results</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-20" title="20">        <span class="va">form</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-21" title="21">        <span class="va">clearBtn</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-22" title="22">    <span class="op">}</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="op">};</span></a>
<a class="sourceLine" id="cb3-24" title="24"></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="kw">function</span> <span class="at">reset</span>(e) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-26" title="26">    <span class="va">e</span>.<span class="at">preventDefault</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-27" title="27">    <span class="co">//clear local storage for region only</span></a>
<a class="sourceLine" id="cb3-28" title="28">    <span class="va">localStorage</span>.<span class="at">removeItem</span>(<span class="st">&#39;regionName&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-29" title="29">    <span class="at">init</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="op">}</span></a></code></pre></div>
<p>함수에는, 약간의 흥미로운 로직이 있습니다. 이것을 읽어보면, 어떤 것이 보이나요?</p>
<ul>
<li>사용자가 로컬 저장소에 APIKey 및 지역 코드를 저장했는지 확인하기 위해 두 ’const’가 설정됩니다.</li>
<li>둘 중 하나가 null이면, ’block’으로 출력되도록 스타일을 변경하여 폼을 나타냅니다.</li>
<li>결과를 숨기거나, 불러오고, 또한 clearBtn을 숨기며 오류 텍스트를 빈 문자열로 설정합니다</li>
<li>키와 지역이 존재하는 경우에는, 다음 루틴이 시작됩니다:
<ul>
<li>탄소 사용량 데이터를 얻기 위한 API 호출</li>
<li>결과 영역 숨기기</li>
<li>폼 숨기기</li>
<li>리셋 버튼 보이기</li>
</ul></li>
</ul>
<p>계속 진행하기 전, 브라우저에서 사용할 수 있는 매우 중요한 개념: <a href="https://developer.mozilla.org/docs/Web/API/Window/localStorage">LocalStorage</a>에 대해 알아 보는 것이 좋습니다. LocalStorage는 브라우저에 문자열을 <code>key-value</code> 쌍으로 저장하는 유용한 방법입니다. 이런 타입의 웹 저장소는 브라우저에서 데이터를 관리하기 위해 JavaScript로 제어할 수 있습니다. LocalStorage는 만료되지 않지만, 다른 종류의 웹 저장소인 SessionStorage는 브라우저를 닫는 즉시 지워집니다. 다양한 타입의 저장소를 사용하는 것은 장점과 단점이 존재합니다.</p>
<blockquote>
<p>Note - 이 브라우저 확장은 로컬 저장소를 가집니다; 주요 브라우저 창은 각자 다른 객체이며 별도로 동작합니다.</p>
</blockquote>
<p>APIKey를 문자열 값으로 설정한다고 하면, 예를 들어 웹 페이지를 “inspecting” 하고 (브라우저를 우측 클릭하여 검사할 수 있습니다) 애플리케이션 탭으로 이동하여 저장소를 확인했을 때 Edge에 설정되어 있다는 것을 볼 수 있습니다.</p>
<figure>
<img src="../images/localstorage.png" alt="Local storage pane" /><figcaption>Local storage pane</figcaption>
</figure>
<p>✅ LocalStorage에 일부 데이터를 저장하기 꺼리는 상황을 생각해보세요. 일반적으로 API 키를 LocalStorage에 배치하는 것은 좋지 않은 생각입니다! 알 수 있나요? 우리 경우, 앱은 순수하게 학습을 위함이고, 앱 스토어에도 배포하지 않으므로 이 방법을 사용합니다.</p>
<p>Web API로 <code>getItem()</code>, <code>setItem()</code> 또는 <code>removeItem()</code>을 사용하여 LocalStorage를 제어합니다. 대부분 브라우저에서 광범위하게 지원됩니다.</p>
<p><code>init()</code>에서 호출되는 <code>displayCarbonUsage()</code> 함수를 만들기 전에 초기 폼 제출을 하는 기능을 만들어 보겠습니다.</p>
<h3 id="양식-제출-제어하기">양식 제출 제어하기</h3>
<p>이벤트 인자 <code>(e)</code>를 받는 <code>handleSubmit</code> 함수를 만듭니다. 이벤트 전달을 중단하고(브라우저 새로 고침을 중단) <code>apiKey.value</code>와 <code>region.value</code> 인자를 전달하는 새로운 함수 <code>setUpUser</code> 를 호출합니다. 이런 방식으로, 적절한 필드가 채워지는 순간 초기 폼을 통해 가져온 두 값을 사용합니다.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">function</span> <span class="at">handleSubmit</span>(e) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">    <span class="va">e</span>.<span class="at">preventDefault</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="at">setUpUser</span>(<span class="va">apiKey</span>.<span class="at">value</span><span class="op">,</span> <span class="va">region</span>.<span class="at">value</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="op">}</span></a></code></pre></div>
<p>✅ 메모리를 초기화합니다 - 지난 강의에서 설정한 HTML에는 파일 상단에 지정한 <code>const</code>를 통해 <code>values</code>이 잡히는 두 입력 필드가 있으며, 둘 다 <code>required</code>이므로 브라우저에서 사용자가 null 값을 입력하지 못하도록 합니다.</p>
<h3 id="사용자-설정하기">사용자 설정하기</h3>
<p><code>setUpUser</code> 함수로 이동하고, 여기에 apiKey와 regionName에 대한 로컬 저장소 값을 설정합니다. 새로운 함수를 추가합니다:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">function</span> <span class="at">setUpUser</span>(apiKey<span class="op">,</span> regionName) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">    <span class="va">localStorage</span>.<span class="at">setItem</span>(<span class="st">&#39;apiKey&#39;</span><span class="op">,</span> apiKey)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="va">localStorage</span>.<span class="at">setItem</span>(<span class="st">&#39;regionName&#39;</span><span class="op">,</span> regionName)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="va">loading</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5">    <span class="va">errors</span>.<span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-6" title="6">    <span class="va">clearBtn</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-7" title="7">    <span class="co">//make initial call</span></a>
<a class="sourceLine" id="cb5-8" title="8">    <span class="at">displayCarbonUsage</span>(apiKey<span class="op">,</span> regionName)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="op">}</span></a></code></pre></div>
<p>이 함수는 API가 호출되는 동안 로딩 메시지를 설정하게 합니다. 핵심으로, 이 브라우저 확장의 가장 중요한 함수를 만드는 데 도달했습니다!</p>
<h3 id="탄소-사용량-출력하기">탄소 사용량 출력하기</h3>
<p>마지막으로 API 쿼리할 시간입니다!</p>
<p>계속 진행하기 전에, API에 대해 논의해야 합니다. API, 또는 <a href="https://www.webopedia.com/TERM/A/API.html">Application Programming Interfaces</a>는 웹 개발자의 툴박스에서 중요한 요소입니다. 프로그램이 상호 작용하거나 할 수 있게 도와주는 표준 방법을 제공합니다. 예시로, 데이터베이스를 쿼리할 웹 사이트를 구축하는 경우, 누군가 사용할 API를 만들었을 수 있습니다. 다양한 유형의 API가 있지만 가장 인기있는 API 중 하나는 <a href="https://www.smashingmagazine.com/2018/01/understanding-using-rest-api/">REST API</a>입니다.</p>
<p>✅ ’REST’라는 용어는 ’Representational State Transfer’를 의미하고 데이터를 가져오기 위해서 다양하게-구성된 URL을 쓰는 기능입니다. 개발자가 사용할 수 있는 다양한 타입의 API에 대해 약간 알아보십시오. 어떤 포맷이 좋습니까?</p>
<p>이 함수에 대해 유의해야 할 중요 사항이 있습니다. 먼저 <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function"><code>async</code> keyword</a>를 확인합니다. 비동기로 실행되도록 함수를 작성한다는 것은 수행되기 전 데이터 반환 작업이 완료될 때를 기다린다는 점을 의미합니다.</p>
<p>다음은 <code>async</code>에 대한 간단한 영상입니다 :</p>
<p><a href="https://youtube.com/watch?v=YwmlRkrxvkk" title="Async and Await for managing promises"><img src="https://img.youtube.com/vi/YwmlRkrxvkk/0.jpg" alt="Async and Await for managing promises" /></a></p>
<p>C02Signal API를 쿼리할 새로운 함수를 만듭니다:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="im">import</span> axios <span class="im">from</span> <span class="st">&#39;../node_modules/axios&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">async</span> <span class="kw">function</span> <span class="at">displayCarbonUsage</span>(apiKey<span class="op">,</span> region) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-5" title="5">        <span class="cf">await</span> axios</a>
<a class="sourceLine" id="cb6-6" title="6">            .<span class="at">get</span>(<span class="st">&#39;https://api.co2signal.com/v1/latest&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-7" title="7">                <span class="dt">params</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-8" title="8">                    <span class="dt">countryCode</span><span class="op">:</span> region<span class="op">,</span></a>
<a class="sourceLine" id="cb6-9" title="9">                <span class="op">},</span></a>
<a class="sourceLine" id="cb6-10" title="10">                <span class="dt">headers</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-11" title="11">                    <span class="st">&#39;auth-token&#39;</span><span class="op">:</span> apiKey<span class="op">,</span></a>
<a class="sourceLine" id="cb6-12" title="12">                <span class="op">},</span></a>
<a class="sourceLine" id="cb6-13" title="13">            <span class="op">}</span>)</a>
<a class="sourceLine" id="cb6-14" title="14">            .<span class="at">then</span>((response) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-15" title="15">                <span class="kw">let</span> CO2 <span class="op">=</span> <span class="va">Math</span>.<span class="at">floor</span>(<span class="va">response</span>.<span class="va">data</span>.<span class="va">data</span>.<span class="at">carbonIntensity</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-16" title="16"></a>
<a class="sourceLine" id="cb6-17" title="17">                <span class="co">//calculateColor(CO2);</span></a>
<a class="sourceLine" id="cb6-18" title="18"></a>
<a class="sourceLine" id="cb6-19" title="19">                <span class="va">loading</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-20" title="20">                <span class="va">form</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-21" title="21">                <span class="va">myregion</span>.<span class="at">textContent</span> <span class="op">=</span> region<span class="op">;</span></a>
<a class="sourceLine" id="cb6-22" title="22">                <span class="va">usage</span>.<span class="at">textContent</span> <span class="op">=</span></a>
<a class="sourceLine" id="cb6-23" title="23">                    <span class="va">Math</span>.<span class="at">round</span>(<span class="va">response</span>.<span class="va">data</span>.<span class="va">data</span>.<span class="at">carbonIntensity</span>) <span class="op">+</span> <span class="st">&#39; grams (grams C02 emitted per kilowatt hour)&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-24" title="24">                <span class="va">fossilfuel</span>.<span class="at">textContent</span> <span class="op">=</span></a>
<a class="sourceLine" id="cb6-25" title="25">                    <span class="va">response</span>.<span class="va">data</span>.<span class="va">data</span>.<span class="va">fossilFuelPercentage</span>.<span class="at">toFixed</span>(<span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-26" title="26">                    <span class="st">&#39;% (percentage of fossil fuels used to generate electricity)&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-27" title="27">                <span class="va">results</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;block&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-28" title="28">            <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-29" title="29">    <span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-30" title="30">        <span class="va">console</span>.<span class="at">log</span>(error)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-31" title="31">        <span class="va">loading</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-32" title="32">        <span class="va">results</span>.<span class="va">style</span>.<span class="at">display</span> <span class="op">=</span> <span class="st">&#39;none&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-33" title="33">        <span class="va">errors</span>.<span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;Sorry, we have no data for the region you have requested.&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-34" title="34">    <span class="op">}</span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="op">}</span></a></code></pre></div>
<p>이는 큰 함수입니다. 여기에 어떤 일이 일어나고 있나요?</p>
<ul>
<li>좋은 사례에 따라, <code>async</code> 키워드를 사용하여 이 함수가 비동기로 동작하도록 합니다. 이 함수는 API가 데이터를 반환할 때 promise를 반환하므로 <code>try/catch</code> 블록을 포함합니다. API 응답 속도를 제어할 수 없기 때문에 (전혀 응답을 못 받을 수 있습니다!) 확실하지 않은 일은 비동기로 호출하여 처리해야 합니다.</li>
<li>API 키를 사용해서, 지역의 데이터를 얻기 위해 co2signal API를 쿼리하고 있습니다. 이 키를 사용하려면, 헤더 파라미터에 인증 타입을 사용해야 합니다.</li>
<li>API가 응답하면, 이 데이터를 출력하도록 설정한 화면에 응답 데이터의 다양한 요소를 할당합니다.</li>
<li>오류가 있거나, 결과가 없는 경우에는, 오류 메시지가 출력됩니다.</li>
</ul>
<p>✅ 비동기 프로그래밍 패턴을 사용하는 것은 툴박스의 다른 매우 유용한 도구입니다. <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function">about the various ways</a>를 읽고 이런 타입의 코드를 구성할 수 있습니다.</p>
<p>축하합니다! 확장을 빌드하고 (<code>npm run build</code>) 확장 패널에서 새로 고치면, 작동하는 확장이 있습니다! 아이콘만 작동하지 않으며 다음 강의에서 수정할 예정입니다.</p>
<hr />
<h2 id="도전">🚀 도전</h2>
<p>지금까지 이 강의에서 여러 타입의 API에 대해 논의했습니다. 웹 API를 선택하고 제공하는 내용에 대해 자세히 알아보세요. 예시로, <a href="https://developer.mozilla.org/docs/Web/API/HTML_Drag_and_Drop_API">HTML Drag and Drop API</a>와 같은 브라우저에서 쓸 수 있는 API를 보세요. 당신의 의견에 비추어 볼 때 좋은 API를 만드는 방법은 무엇일까요?</p>
<h2 id="강의-후-퀴즈">강의 후 퀴즈</h2>
<p>[Post-lecture quiz][Pre-lecture quiz](https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/26?loc=ko)</p>
<h2 id="리뷰-자기주도-학습">리뷰 &amp; 자기주도 학습</h2>
<p>이 강의에서는 전문 웹 개발자에게 매우 유용한, LocalStorage와 API에 대해 학습했습니다. 어떻게 두 가지가 같이 작동하는지 생각해볼 수 있나요? API에서 사용할 아이템을 저장하는 웹 사이트를 어떻게 설계할지 생각해보세요.</p>
<h2 id="과제">과제</h2>
<p><a href="../assignment.md">Adopt an API</a></p>
</body>
</html>
