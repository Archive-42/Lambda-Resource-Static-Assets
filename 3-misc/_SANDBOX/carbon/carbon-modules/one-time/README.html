<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="one-time">one-time</h1>
<p>Call the supplied function exactly one time. This prevents double callback execution. This module can be used on both Node.js, React-Native, or browsers using Browserify. No magical ES5/6 methods used unlike the <code>once</code> module does (except for the async version).</p>
<h2 id="installation">Installation</h2>
<p>This module is published to the public npm registry and can be installed by running:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npm</span> install --save one-time</a></code></pre></div>
<h2 id="usage-normal">Usage (normal)</h2>
<p>Simply supply the function with the function that should only be called one time:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">var</span> one <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;one-time&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">function</span> <span class="at">load</span>(file<span class="op">,</span> fn) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">  fn <span class="op">=</span> <span class="at">one</span>(fn)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="va">eventemitter</span>.<span class="at">once</span>(<span class="st">&#39;load&#39;</span><span class="op">,</span> fn)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="va">eventemitter</span>.<span class="at">once</span>(<span class="st">&#39;error&#39;</span><span class="op">,</span> fn)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9">  <span class="co">// do stuff</span></a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="va">eventemitter</span>.<span class="at">emit</span>(<span class="st">&#39;error&#39;</span><span class="op">,</span> <span class="kw">new</span> <span class="at">Error</span>(<span class="st">&#39;Failed to load, but still finished&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb2-11" title="11">  <span class="va">eventemitter</span>.<span class="at">emit</span>(<span class="st">&#39;load&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="op">}</span></a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="kw">function</span> <span class="at">example</span>(fn) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-15" title="15">  fn <span class="op">=</span> <span class="at">one</span>(fn)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-16" title="16"></a>
<a class="sourceLine" id="cb2-17" title="17">  <span class="at">fn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-18" title="18">  <span class="at">fn</span>(<span class="st">&#39;also receives all arguments&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-19" title="19">  <span class="at">fn</span>(<span class="st">&#39;it returns the same value&#39;</span>) <span class="op">===</span> <span class="st">&#39;bar&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-20" title="20">  <span class="at">fn</span>(<span class="st">&#39;never&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-21" title="21">  <span class="at">fn</span>(<span class="st">&#39;gonna&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-22" title="22">  <span class="at">fn</span>(<span class="st">&#39;give&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-23" title="23">  <span class="at">fn</span>(<span class="st">&#39;you&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-24" title="24">  <span class="at">fn</span>(<span class="st">&#39;up&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="op">}</span></a>
<a class="sourceLine" id="cb2-26" title="26"></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="at">example</span>(<span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb2-28" title="28">  <span class="cf">return</span> <span class="st">&#39;bar&#39;</span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="usage-async">Usage (async)</h2>
<p>The same pattern is available for <strong>async</strong> functions as well, for that you should import that <code>one-time/async</code> version instead. This one is optimized for <strong>async</strong> and <strong>await</strong> support. It following exactly the same as the normal version but assumes it’s an <code>async function () {}</code> that it’s wrapping instead of a regular function, and it will return an <code>async function() {}</code> instead of a regular function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="im">import</span> one <span class="im">from</span> <span class="st">&#39;one-time/async&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">const</span> fn <span class="op">=</span> <span class="at">one</span>(<span class="kw">async</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="cf">return</span> <span class="cf">await</span> <span class="at">example</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="cf">await</span> <span class="at">fn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="cf">await</span> <span class="at">fn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="cf">await</span> <span class="at">fn</span>()<span class="op">;</span></a></code></pre></div>
<h3 id="why-not-once">Why not <code>once</code>?</h3>
<p>The main reason is that <code>once</code> cannot be used in a browser environment unless it’s ES5 compatible. For a module as simple as this I find that unacceptable. In addition to that it super heavy on the dependency side. So it’s totally not suitable to be used in client side applications.</p>
<p>In addition to that we make sure that your code stays easy to debug as returned functions are named in the same way as your supplied functions. Making heap inspection and stack traces easier to understand.</p>
<h2 id="license">License</h2>
<p><a href="LICENSE">MIT</a></p>
</body>
</html>
