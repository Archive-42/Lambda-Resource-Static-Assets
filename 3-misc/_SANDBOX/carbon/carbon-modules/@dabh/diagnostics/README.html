<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="diagnostics"><code>diagnostics</code></h1>
<p>Diagnostics in the evolution of debug pattern that is used in the Node.js core,<br />
this extremely small but powerful technique can best be compared as feature flags for loggers. The created debug logger is disabled by default but can be enabled without changing a line of code, using flags.</p>
<ul>
<li>Allows debugging in multiple JavaScript environments such as Node.js, browsers and React-Native.</li>
<li>Separated development and production builds to minimize impact on your application when bundled.</li>
<li>Allows for customization of logger, messages, and much more.</li>
</ul>
<figure>
<img src="example.png" alt="Output Example" /><figcaption>Output Example</figcaption>
</figure>
<h2 id="installation">Installation</h2>
<p>The module is released in the public npm registry and can be installed by running:</p>
<pre><code>npm install --save diagnostics</code></pre>
<h2 id="usage">Usage</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#advanced-usage">Advanced usage</a>
<ul>
<li><a href="#production-and-development-builds">Production and development builds</a>
<ul>
<li><a href="#webpack">WebPack</a></li>
<li><a href="#nodejs">Node.js</a></li>
</ul></li>
</ul></li>
<li><a href="#api">API</a>
<ul>
<li><a href="#enabled">.enabled</a></li>
<li><a href="#namespace">.namespace</a></li>
<li><a href="#devprod">.dev/prod</a></li>
<li><a href="#set">set</a></li>
<li><a href="#modify">modify</a></li>
<li><a href="#use">use</a></li>
</ul></li>
<li><a href="#modifiers">Modifiers</a>
<ul>
<li><a href="#namespace-1">namespace</a></li>
</ul></li>
<li><a href="#adapters">Adapters</a>
<ul>
<li><a href="#process-env">process.env</a></li>
<li><a href="#hash">hash</a></li>
<li><a href="#localstorage">localStorage</a></li>
<li><a href="#asyncstorage">AsyncStorage</a></li>
</ul></li>
<li><a href="#loggers">Loggers</a></li>
</ul>
<h3 id="introduction">Introduction</h3>
<p>To create a new logger simply <code>require</code> the <code>diagnostics</code> module and call the returned function. It accepts 2 arguments:</p>
<ol type="1">
<li><code>namespace</code> <strong>Required</strong> This is the namespace of your logger so we know if we need to enable your logger when a debug flag is used. Generally you use the name of your library or application as first root namespace. For example if you’re building a parser in a library (example) you would set namespace <code>example:parser</code>.</li>
<li><code>options</code> An object with additional configuration for the logger. following keys are recognized:
<ul>
<li><code>force</code> Force the logger to be enabled.</li>
<li><code>colors</code> Colors are enabled by default for the logs, but you can set this option to <code>false</code> to disable it.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)(<span class="st">&#39;foo:bar:baz&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)(<span class="st">&#39;foo:bar:baz&#39;</span><span class="op">,</span> <span class="op">{</span> options <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="at">debug</span>(<span class="st">&#39;this is a log message %s&#39;</span><span class="op">,</span> <span class="st">&#39;that will only show up when enabled&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="at">debug</span>(<span class="st">&#39;that is pretty neat&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">log</span><span class="op">:</span> <span class="st">&#39;more&#39;</span><span class="op">,</span> <span class="dt">data</span><span class="op">:</span> <span class="dv">1337</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Unlike <code>console.log</code> statements that add and remove during your development lifecycle you create meaningful log statements that will give you insight in the library or application that you’re developing.</p>
<p>The created debugger uses different “adapters” to extract the debug flag out of the JavaScript environment. To learn more about enabling the debug flag in your specific environment click on one of the enabled adapters below.</p>
<ul>
<li><strong>browser</strong>: <a href="#localstorage">localStorage</a>, <a href="#hash">hash</a></li>
<li><strong>node.js</strong>: <a href="#processenv">environment variables</a></li>
<li><strong>react-native</strong>: <a href="#asyncstorage">AsyncStorage</a></li>
</ul>
<p>Please note that the returned logger is fully configured out of the box, you do not need to set any of the adapters/modifiers your self, they are there for when you want more advanced control over the process. But if you want to learn more about that, read the next section.</p>
<h3 id="advanced-usage">Advanced usage</h3>
<p>There are 2 specific usage patterns for <code>diagnostic</code>, library developers who implement it as part of their modules and applications developers who either use it in their application or are searching for ways to consume the messages.</p>
<p>With the simple log interface as discussed in the <a href="#introduction">introduction</a> section we make it easy for developers to add it as part of their libraries and applications, and with powerful <a href="#api">API</a> we allow infinite customization by allowing custom adapters, loggers and modifiers to ensure that this library maintains relevant. These methods not only allow introduction of new loggers, but allow you think outside the box. For example you can maintain a history of past log messages, and output those when an uncaught exception happens in your application so you have additional context</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> diagnostics <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">let</span> index <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">const</span> limit <span class="op">=</span> <span class="dv">200</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">const</span> history <span class="op">=</span> <span class="kw">new</span> <span class="at">Array</span>(limit)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">//</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">// Force all `diagnostic` loggers to be enabled.</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">//</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="va">diagnostics</span>.<span class="at">force</span> <span class="op">=</span> <span class="va">process</span>.<span class="va">env</span>.<span class="at">NODE_ENV</span> <span class="op">===</span> <span class="st">&#39;prod&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="va">diagnostics</span>.<span class="at">set</span>(<span class="kw">function</span> <span class="at">customLogger</span>(meta<span class="op">,</span> message) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-12" title="12">  history[index]<span class="op">=</span> <span class="op">{</span> meta<span class="op">,</span> message<span class="op">,</span> <span class="dt">now</span><span class="op">:</span> <span class="va">Date</span>.<span class="at">now</span>() <span class="op">};</span></a>
<a class="sourceLine" id="cb3-13" title="13">  <span class="cf">if</span> (index<span class="op">++</span> <span class="op">===</span> limit) index <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-14" title="14"></a>
<a class="sourceLine" id="cb3-15" title="15">  <span class="co">//</span></a>
<a class="sourceLine" id="cb3-16" title="16">  <span class="co">// We&#39;re running a development build, so output.</span></a>
<a class="sourceLine" id="cb3-17" title="17">  <span class="co">//</span></a>
<a class="sourceLine" id="cb3-18" title="18">  <span class="cf">if</span> (<span class="va">meta</span>.<span class="at">dev</span>) <span class="va">console</span>.<span class="va">log</span>.<span class="at">apply</span>(console<span class="op">,</span> message)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-20" title="20"></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="va">process</span>.<span class="at">on</span>(<span class="st">&#39;uncaughtException&#39;</span><span class="op">,</span> <span class="kw">async</span> <span class="kw">function</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-22" title="22">  <span class="cf">await</span> <span class="at">saveErrorToDisk</span>(err<span class="op">,</span> history)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-23" title="23">  <span class="va">process</span>.<span class="at">exit</span>(<span class="dv">1</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The small snippet above will maintain a 200 limited FIFO (First In First Out) queue of all debug messages that can be referenced when your application crashes</p>
<h4 id="production-and-development-builds">Production and development builds</h4>
<p>When you <code>require</code> the <code>diagnostics</code> module you will be given a logger that is optimized for <code>development</code> so it can provide the best developer experience possible.</p>
<p>The development logger enables all the <a href="#adapters">adapters</a> for your JavaScript environment, adds a logger that outputs the messages to <code>console.log</code> and registers our message modifiers so log messages will be prefixed with the supplied namespace so you know where the log messages originates from.</p>
<p>The development logger does not have any adapter, modifier and logger enabled by default. This ensures that your log messages never accidentally show up in production. However this does not mean that it’s not possible to get debug messages in production. You can <code>force</code> the debugger to be enabled, and supply a <a href="#loggers">custom logger</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">const</span> diagnostics <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">debug</span>(<span class="st">&#39;foo:bar&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">force</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">//</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">// Or enable _every_ diagnostic instance:</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">//</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="va">diagnostics</span>.<span class="at">force</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a></code></pre></div>
<h5 id="webpack">WebPack</h5>
<p>WebPack has the concept of <a href="https://webpack.js.org/concepts/mode/#usage">mode</a>’s which creates different</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="dt">mode</span><span class="op">:</span> <span class="st">&#39;development&#39;</span> <span class="co">// &#39;production&#39;</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="op">}</span></a></code></pre></div>
<p>When you are building your app using the WebPack CLI you can use the <code>--mode</code> flag:</p>
<pre><code>webpack --mode=production app.js -o /dist/bundle.js</code></pre>
<h5 id="node.js">Node.js</h5>
<p>When you are running your app using <code>Node.js</code> you should the <code>NODE_ENV</code> environment variable to <code>production</code> to ensure that you libraries that you import are optimized for production.</p>
<pre><code>NODE_ENV=production node app.js</code></pre>
<h3 id="api">API</h3>
<p>The returned logger exposes some addition properties that can be used used in your application or library:</p>
<h4 id="enabled">.enabled</h4>
<p>The returned logger will have a <code>.enabled</code> property assigned to it. This boolean can be used to check if the logger was enabled:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)(<span class="st">&#39;foo:bar&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="cf">if</span> (<span class="va">debug</span>.<span class="at">enabled</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="co">//</span></a>
<a class="sourceLine" id="cb8-5" title="5">  <span class="co">// Do something special</span></a>
<a class="sourceLine" id="cb8-6" title="6">  <span class="co">//</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="op">}</span></a></code></pre></div>
<p>This property is exposed as:</p>
<ul>
<li>Property on the logger.</li>
<li>Property on the meta/options object.</li>
</ul>
<h4 id="namespace">.namespace</h4>
<p>This is the namespace that you originally provided to the function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)(<span class="st">&#39;foo:bar&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="va">console</span>.<span class="at">log</span>(<span class="va">debug</span>.<span class="at">namespace</span>)<span class="op">;</span> <span class="co">// foo:bar</span></a></code></pre></div>
<p>This property is exposed as:</p>
<ul>
<li>Property on the logger.</li>
<li>Property on the meta/options object.</li>
</ul>
<h4 id="devprod">.dev/prod</h4>
<p>There are different builds available of <code>diagnostics</code>, when you create a production build of your application using <code>NODE_ENV=production</code> you will be given an optimized, smaller build of <code>diagnostics</code> to reduce your bundle size. The <code>dev</code> and <code>prod</code> booleans on the returned logger indicate if you have a production or development version of the logger.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)(<span class="st">&#39;foo:bar&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="cf">if</span> (<span class="va">debug</span>.<span class="at">prod</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-4" title="4">  <span class="co">// do stuff</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>This property is exposed as:</p>
<ul>
<li>Property on the logger.</li>
<li>Property on the meta/options object.</li>
</ul>
<h4 id="set">set</h4>
<p>Sets a new logger as default for <strong>all</strong> <code>diagnostic</code> instances. The passed argument should be a function that write the log messages to where ever you want. It receives 2 arguments:</p>
<ol type="1">
<li><code>meta</code> An object with all the options that was provided to the original logger that wants to write the log message as well as properties of the debugger such as <code>prod</code>, <code>dev</code>, <code>namespace</code>, <code>enabled</code>. See <a href="#api">API</a> for all exposed properties.</li>
<li><code>args</code> An array of the log messages that needs to be written.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)(<span class="st">&#39;foo:more:namespaces&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="va">debug</span>.<span class="at">use</span>(<span class="kw">function</span> <span class="at">logger</span>(meta<span class="op">,</span> args) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="va">console</span>.<span class="at">log</span>(meta)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="va">console</span>.<span class="at">debug</span>(...<span class="at">args</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>This method is exposed as:</p>
<ul>
<li>Method on the logger.</li>
<li>Method on the meta/options object.</li>
<li>Method on <code>diagnostics</code> module.</li>
</ul>
<h4 id="modify">modify</h4>
<p>The modify method allows you add a new message modifier to <strong>all</strong> <code>diagnostic</code> instances. The passed argument should be a function that returns the passed message after modification. The function receives 2 arguments:</p>
<ol type="1">
<li><code>message</code>, Array, the log message.</li>
<li><code>options</code>, Object, the options that were passed into the logger when it was initially created.</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)(<span class="st">&#39;example:modifiers&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="va">debug</span>.<span class="at">modify</span>(<span class="kw">function</span> (message<span class="op">,</span> options) <span class="op">{</span></a>
<a class="sourceLine" id="cb12-4" title="4">  <span class="cf">return</span> messages<span class="op">;</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>This method is exposed as:</p>
<ul>
<li>Method on the logger.</li>
<li>Method on the meta/options object.</li>
<li>Method on <code>diagnostics</code> module.</li>
</ul>
<p>See <a href="#modifiers">modifiers</a> for more information.</p>
<h4 id="use">use</h4>
<p>Adds a new <code>adapter</code> to <strong>all</strong> <code>diagnostic</code> instances. The passed argument should be a function returns a boolean that indicates if the passed in <code>namespace</code> is allowed to write log messages.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">const</span> diagnostics <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">diagnostics</span>(<span class="st">&#39;foo:bar&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="va">debug</span>.<span class="at">use</span>(<span class="kw">function</span> (namespace) <span class="op">{</span></a>
<a class="sourceLine" id="cb13-5" title="5">  <span class="cf">return</span> namespace <span class="op">===</span> <span class="st">&#39;foo:bar&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>This method is exposed as:</p>
<ul>
<li>Method on the logger.</li>
<li>Method on the meta/options object.</li>
<li>Method on <code>diagnostics</code> module.</li>
</ul>
<p>See <a href="#adapters">adapters</a> for more information.</p>
<h3 id="modifiers">Modifiers</h3>
<p>To be as flexible as possible when it comes to transforming messages we’ve come up with the concept of <code>modifiers</code> which can enhance the debug messages. This allows you to introduce functionality or details that you find important for debug messages, and doesn’t require us to add additional bloat to the <code>diagnostic</code> core.</p>
<p>For example, you want the messages to be prefixed with the date-time of when the log message occured:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">const</span> diagnostics <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="va">diagnostics</span>.<span class="at">modify</span>(<span class="kw">function</span> <span class="at">datetime</span>(args<span class="op">,</span> options) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="va">args</span>.<span class="at">unshift</span>(<span class="kw">new</span> <span class="at">Date</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb14-5" title="5">  <span class="cf">return</span> args<span class="op">;</span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Now all messages will be prefixed with date that is outputted by <code>new Date()</code>. The following modifiers are shipped with <code>diagnostics</code> and are enabled in <strong>development</strong> mode only:</p>
<ul>
<li><a href="#namespace">namespace</a></li>
</ul>
<h4 id="namespace-1">namespace</h4>
<p>This modifier is enabled for all debug instances and prefixes the messages with the name of namespace under which it is logged. The namespace is colored using the <code>colorspace</code> module which groups similar namespaces under the same colorspace. You can have multiple namespaces for the debuggers where each namespace should be separated by a <code>:</code></p>
<pre><code>foo
foo:bar
foo:bar:baz</code></pre>
<p>For console based output the <code>namespace-ansi</code> is used.</p>
<h3 id="adapters">Adapters</h3>
<p>Adapters allows <code>diagnostics</code> to pull the <code>DEBUG</code> and <code>DIAGNOSTICS</code> environment variables from different sources. Not every JavaScript environment has a <code>process.env</code> that we can leverage. Adapters allows us to have different adapters for different environments. It means you can write your own custom adapter if needed as well.</p>
<p>The <code>adapter</code> function should be passed a function as argument, this function will receive the <code>namespace</code> of a logger as argument and it should return a boolean that indicates if that logger should be enabled or not.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">const</span> debug <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diagnostics&#39;</span>)(<span class="st">&#39;example:namespace&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="va">debug</span>.<span class="at">adapter</span>(<span class="at">require</span>(<span class="st">&#39;diagnostics/adapters/localstorage&#39;</span>))<span class="op">;</span></a></code></pre></div>
<p>The modifiers are only enabled for <code>development</code>. The following adapters are available are available:</p>
<h4 id="process.env">process.env</h4>
<p>This adapter is enabled for <code>node.js</code>.</p>
<p>Uses the <code>DEBUG</code> or <code>DIAGNOSTICS</code> (both are recognized) environment variables to pass in debug flag:</p>
<p><strong>UNIX/Linux/Mac</strong></p>
<pre><code>DEBUG=foo* node index.js</code></pre>
<p>Using environment variables on Windows is a bit different, and also depends on toolchain you are using:</p>
<p><strong>Windows</strong></p>
<pre><code>set DEBUG=foo* &amp; node index.js</code></pre>
<p><strong>Powershell</strong></p>
<pre><code>$env:DEBUG=&#39;foo*&#39;;node index.js</code></pre>
<h4 id="hash">hash</h4>
<p>This adapter is enabled for <code>browsers</code>.</p>
<p>This adapter uses the <code>window.location.hash</code> of as source for the environment variables. It assumes that hash is formatted using the same syntax as query strings:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1">http<span class="op">:</span><span class="co">//example.com/foo/bar#debug=foo*</span></a></code></pre></div>
<p>It triggers on both the <code>debug=</code> and <code>diagnostics=</code> names.</p>
<h4 id="localstorage">localStorage</h4>
<p>This adapter is enabled for <code>browsers</code>.</p>
<p>This adapter uses the <code>localStorage</code> of the browser to store the debug flags. You can set the debug flag your self in your application code, but you can also open browser WebInspector and enable it through the console.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="va">localStorage</span>.<span class="at">setItem</span>(<span class="st">&#39;debug&#39;</span><span class="op">,</span> <span class="st">&#39;foo*&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>It triggers on both the <code>debug</code> and <code>diagnostics</code> storage items. (Please note that these keys should be entered in lowercase)</p>
<h4 id="asyncstorage">AsyncStorage</h4>
<p>This adapter is enabled for <code>react-native</code>.</p>
<p>This adapter uses the <code>AsyncStorage</code> API that is exposed by the <code>react-native</code> library to store and read the <code>debug</code> or <code>diagnostics</code> storage items.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="im">import</span> <span class="op">{</span> AsyncStorage <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-native&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb22-2" title="2"></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="va">AsyncStorage</span>.<span class="at">setItem</span>(<span class="st">&#39;debug&#39;</span><span class="op">,</span> <span class="st">&#39;foo*&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>Unlike other adapters, this is the only adapter that is <code>async</code> so that means that we’re not able to instantly determine if a created logger should be enabled or disabled. So when a logger is created in <code>react-native</code> we initially assume it’s disabled, any message that send during period will be queued internally.</p>
<p>Once we’ve received the data from the <code>AsyncStorage</code> API we will determine if the logger should be enabled, flush the queued messages if needed and set all <code>enabled</code> properties accordingly on the returned logger.</p>
<h3 id="loggers">Loggers</h3>
<p>By default it will log all messages to <code>console.log</code> in when the logger is enabled using the debug flag that is set using one of the adapters.</p>
<h2 id="license">License</h2>
<p><a href="LICENSE">MIT</a></p>
</body>
</html>
