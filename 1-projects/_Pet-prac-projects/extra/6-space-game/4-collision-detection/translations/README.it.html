<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README.it</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="costruire-un-gioco-spaziale-parte-4-aggiungere-un-laser-e-rilevare-le-collisioni">Costruire un Gioco Spaziale Parte 4: Aggiungere un Laser e Rilevare le Collisioni</h1>
<h2 id="quiz-pre-lezione">Quiz Pre-Lezione</h2>
<p><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/35?loc=it">Quiz Pre-Lezione</a></p>
<p>In questa lezione si imparererà come fare fuoco con i laser con JavaScript! Verranno aggiunte due cose al gioco:</p>
<ul>
<li><strong>Un laser</strong>: questo laser viene sparato dall’astronave del proprio eroe e verticalmente verso l’alto</li>
<li><strong>Rilevamento delle collisioni</strong>, come parte dell’implementazione della capacità di <em>sparare</em> , si aggiungeranno anche alcune simpatiche regole di gioco:
<ul>
<li>Il <strong>laser colpisce il nemico</strong>: il nemico muore se colpito da un laser</li>
<li>Il <strong>laser raggiunge lo schermo superiore</strong>: un laser viene distrutto se raggiunge la parte superiore dello schermo</li>
<li><strong>Collisione tra nemico ed eroe</strong>: un nemico e l’eroe vengono distrutti se entrano in collisione</li>
<li>Il <strong>nemico raggiunge la parte inferiore dello schermo</strong>: un nemico e un eroe vengono distrutti se il nemico raggiunge la parte inferiore dello schermo</li>
</ul></li>
</ul>
<p>In breve, il giocatore - <em>l’eroe</em> - deve colpire tutti i nemici con un laser prima che riescano a raggiungere la parte inferiore dello schermo.</p>
<p>✅ Fare una piccola ricerca sul primissimo gioco per computer mai scritto. Qual era la sua funzionalità?</p>
<p>Diventiamo eroici insieme!</p>
<h2 id="rilevamento-della-collisione.">Rilevamento della collisione.</h2>
<p>Come si rilevano le collisioni? Occorre pensare agli oggetti di gioco come rettangoli che si muovono. Perché, ci si potrebbe chiedere? Bene, l’immagine usata per disegnare un oggetto di gioco è un rettangolo: ha una <code>x</code>, una <code>y</code>, una larghezza (<code>width</code>) e un’altezza (<code>height</code>).</p>
<p>Se due rettangoli, cioè un eroe e un nemico <em>si intersecano</em>, si verifica una collisione. Ciò che dovrebbe accadere dipende dalle regole del gioco. Per implementare il rilevamento delle collisioni è quindi necessario quanto segue:</p>
<ol type="1">
<li><p>Un modo per ottenere una rappresentazione rettangolare di un oggetto di gioco, qualcosa del genere:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="at">rectFromGameObject</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="dt">top</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">y</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="dt">left</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">x</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="dt">bottom</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">y</span> <span class="op">+</span> <span class="kw">this</span>.<span class="at">height</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-6" title="6">    <span class="dt">right</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">x</span> <span class="op">+</span> <span class="kw">this</span>.<span class="at">width</span></a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="op">}</span></a></code></pre></div></li>
<li><p>Una funzione di confronto, questa funzione può assomigliare a questa:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">function</span> <span class="at">intersectRect</span>(r1<span class="op">,</span> r2) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="cf">return</span> <span class="op">!</span>(<span class="va">r2</span>.<span class="at">left</span> <span class="op">&gt;</span> <span class="va">r1</span>.<span class="at">right</span> <span class="op">||</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="va">r2</span>.<span class="at">right</span> <span class="op">&lt;</span> <span class="va">r1</span>.<span class="at">left</span> <span class="op">||</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="va">r2</span>.<span class="at">top</span> <span class="op">&gt;</span> <span class="va">r1</span>.<span class="at">bottom</span> <span class="op">||</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="va">r2</span>.<span class="at">bottom</span> <span class="op">&lt;</span> <span class="va">r1</span>.<span class="at">top</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="op">}</span></a></code></pre></div></li>
</ol>
<h2 id="come-si-distruggono-le-cose">Come si distruggono le cose</h2>
<p>Per distruggere le cose in un gioco si deve far sapere al gioco stesso che non dovrebbe più disegnare un certo oggetto nel ciclo di gioco che si attiva in un certo intervallo. Un modo per farlo è contrassegnare un oggetto del gioco come <em>morto</em> quando succede qualcosa, in questo modo:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="co">// si è verificata una collisione</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="va">enemy</span>.<span class="at">dead</span> <span class="op">=</span> <span class="kw">true</span></a></code></pre></div>
<p>Quindi si procede a filtrare gli oggetti <em>morti</em> prima di ridipingere lo schermo, in questo modo:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1">gameObjects <span class="op">=</span> <span class="va">gameObject</span>.<span class="at">filter</span>(go <span class="kw">=&gt;</span> <span class="op">!</span><span class="va">go</span>.<span class="at">dead</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="come-si-spara-un-laser">Come si spara un laser</h2>
<p>Sparare un laser si traduce nel rispondere a un evento da tastiera e creare un oggetto che si muove in una certa direzione. Occorre quindi eseguire i seguenti passaggi:</p>
<ol type="1">
<li><strong>Creare un oggetto laser</strong>: dalla cima dell’ astronave dell’eroe, che al momento della creazione inizia a muoversi in alto verso la parte superiore dello schermo.</li>
<li><strong>Allegare codice a un evento da tastiera</strong>: si deve scegliere un tasto sulla tastiera che rappresenti il giocatore che spara il laser.</li>
<li><strong>Creare un oggetto di gioco che assomigli a un laser</strong> quando viene premuto il tasto.</li>
</ol>
<h2 id="raffreddamento-del-laser">Raffreddamento del laser</h2>
<p>Il laser deve attivarsi ogni volta che si preme un tasto, come ad esempio la <em>barra spazio</em>. Per evitare che il gioco produca troppi laser in breve tempo, si deve risolvere questo problema. La soluzione è implementando un cosiddetto raffreddamento (<em>cooldown</em>), un timer, che garantisce che un laser possa essere sparato solo a intervallo determinato. Su può implementare nel modo seguente:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">class</span> Cooldown <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="at">constructor</span>(time) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="kw">this</span>.<span class="at">cool</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-5" title="5">      <span class="kw">this</span>.<span class="at">cool</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-6" title="6">    <span class="op">},</span> time)</a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb5-9" title="9"></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="kw">class</span> Weapon <span class="op">{</span></a>
<a class="sourceLine" id="cb5-11" title="11">  constructor <span class="op">{</span></a>
<a class="sourceLine" id="cb5-12" title="12">  <span class="op">}</span></a>
<a class="sourceLine" id="cb5-13" title="13">  <span class="at">fire</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb5-14" title="14">    <span class="cf">if</span> (<span class="op">!</span><span class="kw">this</span>.<span class="at">cooldown</span> <span class="op">||</span> <span class="kw">this</span>.<span class="va">cooldown</span>.<span class="at">cool</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-15" title="15">      <span class="co">// produce un laser</span></a>
<a class="sourceLine" id="cb5-16" title="16">      <span class="kw">this</span>.<span class="at">cooldown</span> <span class="op">=</span> <span class="kw">new</span> <span class="at">Cooldown</span>(<span class="dv">500</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-17" title="17">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-18" title="18">      <span class="co">// non fa nulla - non si è ancora raffreddato</span></a>
<a class="sourceLine" id="cb5-19" title="19">    <span class="op">}</span></a>
<a class="sourceLine" id="cb5-20" title="20">  <span class="op">}</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="op">}</span></a></code></pre></div>
<p>✅ Fare riferimento alla lezione 1 della serie gioco spaziale per quanto riguarda i tempi di <em>cooldown</em> (raffreddamento).</p>
<h2 id="cosa-costruire">Cosa costruire</h2>
<p>Si prende il codice esistente (che dovrebbe essere stato ripulito e rifattorizzato) dalla lezione precedente e lo si estende Si inizia con il codice della parte II o si usa il codice <a href="../your-work">della parte III-starter</a>.</p>
<blockquote>
<p>suggerimento: il laser con cui lavorare è già nella cartella asset ed è referenziato nel proprio codice</p>
</blockquote>
<ul>
<li><strong>Aggiungere il rilevamento delle collisioni</strong>, quando un laser entra in collisione con qualcosa dovrebbero essere applicate le seguenti regole:
<ol type="1">
<li>Il <strong>laser colpisce il nemico</strong>: il nemico muore se colpito da un laser</li>
<li>Il <strong>laser raggiunge lo schermo superiore</strong>: un laser viene distrutto se raggiunge la parte superiore dello schermo</li>
<li><strong>Collisione tra nemico ed eroe</strong>: un nemico e l’eroe vengono distrutti se entrano in collisione</li>
<li>Il <strong>nemico colpisce la parte inferiore dello schermo</strong>: un nemico e un eroe vengono distrutti se il nemico raggiunge la parte inferiore dello schermo</li>
</ol></li>
</ul>
<h2 id="passaggi-consigliati">Passaggi consigliati</h2>
<p>Individuare i file che già sono stati creati nella sottocartella <code>your-work</code>. Dovrebbe contenere quanto segue:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="ex">-</span><span class="kw">|</span> <span class="ex">assets</span></a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="ex">-</span><span class="kw">|</span> <span class="ex">enemyShip.png</span></a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="ex">-</span><span class="kw">|</span> <span class="ex">player.png</span></a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="ex">-</span><span class="kw">|</span> <span class="ex">laserRed.png</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="ex">-</span><span class="kw">|</span> <span class="ex">index.html</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="ex">-</span><span class="kw">|</span> <span class="ex">app.js</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="ex">-</span><span class="kw">|</span> <span class="ex">package.json</span></a></code></pre></div>
<p>Si fa partire il progetto nella cartella <code>your_work</code> digitando:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="bu">cd</span> your-work</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="ex">npm</span> start</a></code></pre></div>
<p>Quanto sopra avvierà un server HTTP sull’indirizzo <code>http://localhost:5000</code>. Aprire un browser e inserire quell’indirizzo, in questo momento dovrebbe rendere l’eroe e tutti i nemici.</p>
<h3 id="aggiungere-codice">Aggiungere codice</h3>
<ol type="1">
<li><p><strong>Impostare una rappresentazione di un rettangolo di un oggetto di gioco, per gestire la collisione</strong>. Il codice seguente consente di ottenere una rappresentazione di un rettangolo di un <code>GameObject</code>. Modificare la classe GameObject per estenderla:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="at">rectFromGameObject</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-2" title="2">    <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-3" title="3">      <span class="dt">top</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">y</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-4" title="4">      <span class="dt">left</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">x</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-5" title="5">      <span class="dt">bottom</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">y</span> <span class="op">+</span> <span class="kw">this</span>.<span class="at">height</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-6" title="6">      <span class="dt">right</span><span class="op">:</span> <span class="kw">this</span>.<span class="at">x</span> <span class="op">+</span> <span class="kw">this</span>.<span class="at">width</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-7" title="7">    <span class="op">};</span></a>
<a class="sourceLine" id="cb8-8" title="8">  <span class="op">}</span></a></code></pre></div></li>
<li><p><strong>Aggiungere il codice che controlla la collisione</strong> Questa sarà una nuova funzione che verifica se due rettangoli si intersecano:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">function</span> <span class="at">intersectRect</span>(r1<span class="op">,</span> r2) <span class="op">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="cf">return</span> <span class="op">!</span>(</a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="va">r2</span>.<span class="at">left</span> <span class="op">&gt;</span> <span class="va">r1</span>.<span class="at">right</span> <span class="op">||</span></a>
<a class="sourceLine" id="cb9-4" title="4">    <span class="va">r2</span>.<span class="at">right</span> <span class="op">&lt;</span> <span class="va">r1</span>.<span class="at">left</span> <span class="op">||</span></a>
<a class="sourceLine" id="cb9-5" title="5">    <span class="va">r2</span>.<span class="at">top</span> <span class="op">&gt;</span> <span class="va">r1</span>.<span class="at">bottom</span> <span class="op">||</span></a>
<a class="sourceLine" id="cb9-6" title="6">    <span class="va">r2</span>.<span class="at">bottom</span> <span class="op">&lt;</span> <span class="va">r1</span>.<span class="at">top</span></a>
<a class="sourceLine" id="cb9-7" title="7">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="op">}</span></a></code></pre></div></li>
<li><strong>Aggiungere capacità di fuoco laser</strong>
<ol type="1">
<li><p><strong>Aggiungere messaggio per un evento da tastiera</strong>. Il tasto spazio (<em>space</em>) dovrebbe creare un laser appena sopra la astronave dell’eroe. Aggiungere tre costanti nell’oggetto Messages:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"> KEY_EVENT_SPACE<span class="op">:</span> <span class="st">&quot;KEY_EVENT_SPACE&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-2" title="2"> COLLISION_ENEMY_LASER<span class="op">:</span> <span class="st">&quot;COLLISION_ENEMY_LASER&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-3" title="3"> COLLISION_ENEMY_HERO<span class="op">:</span> <span class="st">&quot;COLLISION_ENEMY_HERO&quot;</span><span class="op">,</span></a></code></pre></div></li>
<li><p><strong>Gestire il tasto barra spazio</strong> Modificare la funzione keyup di <code>window.addEventListener</code> per gestire la barra spazio:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1">  } <span class="cf">else</span> <span class="cf">if</span>(<span class="va">evt</span>.<span class="at">keyCode</span> <span class="op">===</span> <span class="dv">32</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">    <span class="va">eventEmitter</span>.<span class="at">emit</span>(<span class="va">Messages</span>.<span class="at">KEY_EVENT_SPACE</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="op">}</span></a></code></pre></div></li>
<li><p><strong>Aggiungere listener</strong>. Modificare la funzione <code>initGame()</code> per assicurarsi che l’eroe possa sparare quando viene premuta la barra spazio:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="va">eventEmitter</span>.<span class="at">on</span>(<span class="va">Messages</span>.<span class="at">KEY_EVENT_SPACE</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-2" title="2"> <span class="cf">if</span> (<span class="va">hero</span>.<span class="at">canFire</span>()) <span class="op">{</span></a>
<a class="sourceLine" id="cb12-3" title="3">   <span class="va">hero</span>.<span class="at">fire</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4"> <span class="op">}</span></a></code></pre></div>
<p>e aggiungere una nuova funzione <code>eventEmitter.on()</code> per garantire il comportamento quando un nemico si scontra con un laser:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="va">eventEmitter</span>.<span class="at">on</span>(<span class="va">Messages</span>.<span class="at">COLLISION_ENEMY_LASER</span><span class="op">,</span> (_<span class="op">,</span> <span class="op">{</span> first<span class="op">,</span> second <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="va">first</span>.<span class="at">dead</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="va">second</span>.<span class="at">dead</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="op">}</span>)</a></code></pre></div></li>
<li><p><strong>Spostare l’oggetto</strong>, assicurarsi che il laser si muova gradualmente verso parte superiore dello schermo. Creare una nuova classe Laser che estende <code>GameObject</code>, come fatto precedentemente:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1">  <span class="kw">class</span> Laser <span class="kw">extends</span> GameObject <span class="op">{</span></a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="at">constructor</span>(x<span class="op">,</span> y) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-3" title="3">    <span class="kw">super</span>(x<span class="op">,</span>y)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-4" title="4">    (<span class="kw">this</span>.<span class="at">width</span> <span class="op">=</span> <span class="dv">9</span>)<span class="op">,</span> (<span class="kw">this</span>.<span class="at">height</span> <span class="op">=</span> <span class="dv">33</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-5" title="5">    <span class="kw">this</span>.<span class="at">type</span> <span class="op">=</span> <span class="st">&#39;Laser&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-6" title="6">    <span class="kw">this</span>.<span class="at">img</span> <span class="op">=</span> laserImg<span class="op">;</span></a>
<a class="sourceLine" id="cb14-7" title="7">    <span class="kw">let</span> id <span class="op">=</span> <span class="at">setInterval</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-8" title="8">      <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">y</span> <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-9" title="9">        <span class="kw">this</span>.<span class="at">y</span> <span class="op">-=</span> <span class="dv">15</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-10" title="10">      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-11" title="11">        <span class="kw">this</span>.<span class="at">dead</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-12" title="12">        <span class="at">clearInterval</span>(id)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-13" title="13">      <span class="op">}</span></a>
<a class="sourceLine" id="cb14-14" title="14">    <span class="op">},</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb14-15" title="15">  <span class="op">}</span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="op">}</span></a></code></pre></div></li>
<li><p><strong>Gestire le collisioni</strong>, implementare le regole di collisione per il laser. Aggiungere una funzione <code>updateGameObjects()</code> che verifica gli oggetti in collisione per quelli colpiti</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">function</span> <span class="at">updateGameObjects</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="kw">const</span> enemies <span class="op">=</span> <span class="va">gameObjects</span>.<span class="at">filter</span>(go <span class="kw">=&gt;</span> <span class="va">go</span>.<span class="at">type</span> <span class="op">===</span> <span class="st">&#39;Enemy&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-3" title="3">  <span class="kw">const</span> lasers <span class="op">=</span> <span class="va">gameObjects</span>.<span class="at">filter</span>((go) <span class="kw">=&gt;</span> <span class="va">go</span>.<span class="at">type</span> <span class="op">===</span> <span class="st">&quot;Laser&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">// il laser ha colpito qualcosa</span></a>
<a class="sourceLine" id="cb15-5" title="5">  <span class="va">lasers</span>.<span class="at">forEach</span>((l) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-6" title="6">    <span class="va">enemies</span>.<span class="at">forEach</span>((m) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-7" title="7">      <span class="cf">if</span> (<span class="at">intersectRect</span>(<span class="va">l</span>.<span class="at">rectFromGameObject</span>()<span class="op">,</span> <span class="va">m</span>.<span class="at">rectFromGameObject</span>())) <span class="op">{</span></a>
<a class="sourceLine" id="cb15-8" title="8">      <span class="va">eventEmitter</span>.<span class="at">emit</span>(<span class="va">Messages</span>.<span class="at">COLLISION_ENEMY_LASER</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-9" title="9">        <span class="dt">first</span><span class="op">:</span> l<span class="op">,</span></a>
<a class="sourceLine" id="cb15-10" title="10">        <span class="dt">second</span><span class="op">:</span> m<span class="op">,</span></a>
<a class="sourceLine" id="cb15-11" title="11">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-12" title="12">    <span class="op">}</span></a>
<a class="sourceLine" id="cb15-13" title="13">   <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-15" title="15"></a>
<a class="sourceLine" id="cb15-16" title="16">  gameObjects <span class="op">=</span> <span class="va">gameObjects</span>.<span class="at">filter</span>(go <span class="kw">=&gt;</span> <span class="op">!</span><span class="va">go</span>.<span class="at">dead</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="op">}</span>  </a></code></pre></div>
<p>Assicurarsi di aggiungere <code>updateGameObjects()</code> nel ciclo di gioco in <code>window.onload</code>.</p></li>
<li><p><strong>Implementare il</strong> raffreddamento sul laser, in modo che possa essere sparato solo a determinati intervalli.</p>
<p>Infine, modificare la classe Hero in modo che possa eseguire il raffreddamento:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">class</span> Hero <span class="kw">extends</span> GameObject <span class="op">{</span></a>
<a class="sourceLine" id="cb16-2" title="2"> <span class="at">constructor</span>(x<span class="op">,</span> y) <span class="op">{</span></a>
<a class="sourceLine" id="cb16-3" title="3">   <span class="kw">super</span>(x<span class="op">,</span> y)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-4" title="4">   (<span class="kw">this</span>.<span class="at">width</span> <span class="op">=</span> <span class="dv">99</span>)<span class="op">,</span> (<span class="kw">this</span>.<span class="at">height</span> <span class="op">=</span> <span class="dv">75</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-5" title="5">   <span class="kw">this</span>.<span class="at">type</span> <span class="op">=</span> <span class="st">&quot;Hero&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-6" title="6">   <span class="kw">this</span>.<span class="at">speed</span> <span class="op">=</span> <span class="op">{</span> <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> <span class="op">};</span></a>
<a class="sourceLine" id="cb16-7" title="7">   <span class="kw">this</span>.<span class="at">cooldown</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-8" title="8"> <span class="op">}</span></a>
<a class="sourceLine" id="cb16-9" title="9"> <span class="at">fire</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb16-10" title="10">   <span class="va">gameObjects</span>.<span class="at">push</span>(<span class="kw">new</span> <span class="at">Laser</span>(<span class="kw">this</span>.<span class="at">x</span> <span class="op">+</span> <span class="dv">45</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">y</span> <span class="op">-</span> <span class="dv">10</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb16-11" title="11">   <span class="kw">this</span>.<span class="at">cooldown</span> <span class="op">=</span> <span class="dv">500</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-12" title="12"></a>
<a class="sourceLine" id="cb16-13" title="13">   <span class="kw">let</span> id <span class="op">=</span> <span class="at">setInterval</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-14" title="14">     <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">cooldown</span> <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb16-15" title="15">       <span class="kw">this</span>.<span class="at">cooldown</span> <span class="op">-=</span> <span class="dv">100</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-16" title="16">     <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-17" title="17">       <span class="at">clearInterval</span>(id)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-18" title="18">     <span class="op">}</span></a>
<a class="sourceLine" id="cb16-19" title="19">   <span class="op">},</span> <span class="dv">200</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-20" title="20"> <span class="op">}</span></a>
<a class="sourceLine" id="cb16-21" title="21"> <span class="at">canFire</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb16-22" title="22">   <span class="cf">return</span> <span class="kw">this</span>.<span class="at">cooldown</span> <span class="op">===</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-23" title="23"> <span class="op">}</span></a>
<a class="sourceLine" id="cb16-24" title="24"><span class="op">}</span></a></code></pre></div></li>
</ol></li>
</ol>
<p>A questo punto, il tuo gioco ha alcune funzionalità! Si può navigare con i tasti freccia, sparare un laser con la barra spaziatrice e i nemici scompaiono quando colpiti. Ottimo lavoro!</p>
<hr />
<h2 id="sfida">🚀 Sfida</h2>
<p>Aggiungere un’esplosione! Dare un’occhiata alle risorse di gioco <a href="../solution/spaceArt/readme.txt">nel repository Space Art</a> e provare ad aggiungere un’esplosione quando il laser colpisce un alieno</p>
<h2 id="quiz-post-lezione">Quiz Post-Lezione</h2>
<p><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/36?loc=it">Quiz post-lezione</a></p>
<h2 id="revisione-e-auto-apprendimento">Revisione e Auto Apprendimento</h2>
<p>Sperimentare con gli intervalli nel proprio gioco fino ad ora. Cosa succede quando si cambiano? Ulteriori informazioni sugli <a href="https://www.freecodecamp.org/news/javascript-timing-events-settimeout-and-setinterval/">eventi di temporizzazione JavaScript</a>.</p>
<h2 id="compito">Compito</h2>
<p><a href="assignment.it.md">Esplorare le collisioni</a></p>
</body>
</html>
