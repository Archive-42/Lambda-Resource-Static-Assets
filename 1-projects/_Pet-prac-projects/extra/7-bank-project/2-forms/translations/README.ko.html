<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README.ko</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="은행-앱-제작하기-파트-2-로그인과-가입-폼-작성하기">은행 앱 제작하기 파트 2: 로그인과 가입 폼 작성하기</h1>
<h2 id="강의-전-퀴즈">강의 전 퀴즈</h2>
<p><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/43?loc=ko">Pre-lecture quiz</a></p>
<h3 id="소개">소개</h3>
<p>모든 모던 웹 앱에서 대부분은, 자신의 개인 공간을 가질 계정을 만들 수 있습니다. 여러 사용자가 동시에 웹 앱에 접근할 수 있으므로, 각자 사용자의 개인 데이터를 별도로 저장하고 어느 정보를 보여줄 지에 대하여 선택하는 메커니즘이 필요합니다. 자체적으로 광범위한 주제이므로 <a href="https://en.wikipedia.org/wiki/Authentication">user identity securely</a> 관리하는 방법은 다루지 않지만, 각자가 앱에서 하나 (이상)의 은행 계좌를 만들 수 있는지 확인합니다.</p>
<p>이 파트에서는 HTML 폼으로 웹 앱에 로그인과 가입을 추가합니다. 프로그래밍 방식으로 데이터를 서버 API에 보내는 방법과, 최종적으로 사용자 입력에 대한 기본 유효성 검사 규칙을 정의하는 방법에 대해 보겠습니다.</p>
<h3 id="준비물">준비물</h3>
<p>이 강의를 위해 웹 앱의 <a href="../../1-template-route/translations/README.ko.md">HTML templates and routing</a>을 완료해야합니다. 또한 <a href="https://nodejs.org">Node.js</a>와 <a href="../../api/README.md">run the server API</a>를 로컬에 설치해야 계정을 만들 데이터를 보낼 수 있습니다.</p>
<p>터미널에서 다음 명령을 실행하여 서버가 잘 실행되고 있는지 테스트할 수 있습니다:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">curl</span> http://localhost:5000/api</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># -&gt; should return &quot;Bank API v1.0.0&quot; as a result</span></a></code></pre></div>
<hr />
<h2 id="폼과-컨트롤">폼과 컨트롤</h2>
<p><code>&lt;form&gt;</code> 요소는 사용자가 대화형 컨트롤을 사용하여 데이터를 입력하고 제출할 수 있는 HTML 문서의 섹션을 캡슐화합니다. 폼 내에서 쓸 수 있는 모든 종류의 사용자 인터페이스(UI) 컨트롤이 있으며, 가장 일반적인 컨트롤은 <code>&lt;input&gt;</code>과 <code>&lt;button&gt;</code> 요소입니다.</p>
<p><code>&lt;input&gt;</code>에는 다양한 <a href="https://developer.mozilla.org/docs/Web/HTML/Element/input">types</a>이 많이 있습니다, 예를 들어 사용자 이름으로 입력 가능한 필드를 만들려면 다음과 같이 사용할 수 있습니다:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;username&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p><code>name</code> 속성은 컨트롤을 식별하는 데 사용되고 폼 데이터를 전송할 때 속성 이름으로 사용됩니다.</p>
<blockquote>
<p>UI를 작성할 때 쓸 수 있는 모든 네이티브 UI 요소에 대한 아이디어를 얻으려면 <a href="https://developer.mozilla.org/docs/Web/HTML/Element/input"><code>&lt;input&gt;</code> types</a>과 <a href="https://developer.mozilla.org/docs/Learn/Forms/Other_form_controls">other form controls</a>의 전체 목록을 찾아봅시다.</p>
</blockquote>
<p>✅ <code>&lt;input&gt;</code>은 닫는 태그를 맞추지 <em>않는</em> <a href="https://developer.mozilla.org/docs/Glossary/Empty_element">empty element</a>입니다. 자동으로-닫는 <code>&lt;input/&gt;</code> 표기법을 사용할 수 있지만, 필수는 아닙니다.</p>
<p>폼 내의 <code>&lt;button&gt;</code> 요소는 약간 특별합니다. <code>type</code> 속성을 지정하지 않으면, 눌렀을 때 폼 데이터가 자동으로 서버에 제출됩니다. 가능한 <code>type</code> 값은 다음과 같습니다:</p>
<ul>
<li><code>submit</code>: <code>&lt;form&gt;</code>내의 기본값이며, 버튼은 폼 제출 작업으로 연결합니다.</li>
<li><code>reset</code>: 버튼은 모든 폼 컨트롤을 초기 값으로 다시 설정합니다.</li>
<li><code>button</code>: 버튼을 눌렀을 때 기본 동작을 지정하지 않습니다. JavaScript를 사용하여 커스텀 작업을 할당할 수 있습니다.</li>
</ul>
<h3 id="작업">작업</h3>
<p><code>login</code> 템플릿에 폼을 추가하는 것으로 시작하겠습니다. <em>username</em> 필드와 <em>Login</em> 버튼이 필요합니다.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">&lt;template</span><span class="ot"> id=</span><span class="st">&quot;login&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">&lt;h1&gt;</span>Bank App<span class="kw">&lt;/h1&gt;</span></a>
<a class="sourceLine" id="cb3-3" title="3">  <span class="kw">&lt;section&gt;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">&lt;h2&gt;</span>Login<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;loginForm&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-6" title="6">      <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;user&quot;</span><span class="kw">&gt;</span>Username<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb3-7" title="7">      <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;user&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb3-8" title="8">      <span class="kw">&lt;button&gt;</span>Login<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="kw">&lt;/form&gt;</span></a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="kw">&lt;/section&gt;</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="kw">&lt;/template&gt;</span></a></code></pre></div>
<p>자세히 살펴보면, 여기에 <code>&lt;label&gt;</code> 요소도 추가된 것을 알 수 있습니다. <code>&lt;label&gt;</code>은 username 필드와 같은, UI 컨트롤의 캡션을 추가하는 데 사용됩니다. 라벨은 폼의 가독성을 위해서 중요하지만, 추가적인 장점도 제공합니다:</p>
<ul>
<li>라벨을 폼 컨트롤에 연결하면, (화면 판독기와 같은) 보조 기술을 사용하는 사용자가 받는 것으로 예상되는 데이터를 이해하는 데 도움이 됩니다.</li>
<li>라벨을 클릭하여 연결된 입력에 직접 맞출 수 있으므로, 터치-스크린 기반 장치에서 더 쉽게 접근할 수 있습니다.</li>
</ul>
<blockquote>
<p>웹에서의 <a href="https://developer.mozilla.org/docs/Learn/Accessibility/What_is_accessibility">Accessibility</a>은 종종 간과되는 매우 중요한 주제입니다. <a href="https://developer.mozilla.org/docs/Learn/Accessibility/HTML">HTML5 semantic elements</a> 덕분에 이를 적절하게 사용한다면 접근성 콘텐츠로 만드는 것은 어렵지 않습니다. 일반적인 실수를 피하고 책임있는 개발자가 되기 위해 <a href="https://developer.mozilla.org/docs/Web/Accessibility">accessibility에 대하여 읽을 수</a> 있습니다.</p>
</blockquote>
<p>이제 이전 항목의 바로 아래에, 가입을 위한 두번째 폼을 추가합니다:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">&lt;hr/&gt;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">&lt;h2&gt;</span>Register<span class="kw">&lt;/h2&gt;</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;registerForm&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;user&quot;</span><span class="kw">&gt;</span>Username<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;user&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;currency&quot;</span><span class="kw">&gt;</span>Currency<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;currency&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;$&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;description&quot;</span><span class="kw">&gt;</span>Description<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;description&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-10" title="10">  <span class="kw">&lt;label</span><span class="ot"> for=</span><span class="st">&quot;balance&quot;</span><span class="kw">&gt;</span>Current balance<span class="kw">&lt;/label&gt;</span></a>
<a class="sourceLine" id="cb4-11" title="11">  <span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;balance&quot;</span><span class="ot"> type=</span><span class="st">&quot;number&quot;</span><span class="ot"> value=</span><span class="st">&quot;0&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb4-12" title="12">  <span class="kw">&lt;button&gt;</span>Register<span class="kw">&lt;/button&gt;</span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="kw">&lt;/form&gt;</span></a></code></pre></div>
<p><code>value</code> 속성을 사용하여 주어진 입력에 대한 기본값을 정의할 수 있습니다. <code>balance</code>에 대한 입력에는 <code>number</code> 타입이 존재 합니다. 다른 입력과 다르게 보이나요? 상호작용 해보세요.</p>
<p>✅ 키보드만 사용하여 폼을 탐색하고 상호 작용할 수 있나요? 어떻게 하나요?</p>
<h2 id="서버에-데이터-제출하기">서버에 데이터 제출하기</h2>
<p>이제 기능 UI가 있으므로, 다음 단계는 데이터를 서버로 보내는 것입니다. 현재 코드를 사용하여 간단한 테스트를 해봅시다. <em>Login</em> 혹은 <em>Register</em> 버튼을 클릭하면 어떻게 되나요?</p>
<p>브라우저의 URL 섹션에서 변경된 것을 알고 있나요?</p>
<figure>
<img src=".././images/click-register.png" alt="Screenshot of the browser’s URL change after clicking the Register button" /><figcaption>Screenshot of the browser’s URL change after clicking the Register button</figcaption>
</figure>
<p><code>&lt;form&gt;</code>의 기본 작업은 <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3">GET method</a>를 사용하여 현재 서버 URL에 폼을 제출하고, 폼 데이터를 URL에 직접 추가하는 것입니다. 이 방식에는 몇 가지 단점이 있습니다:</p>
<ul>
<li>전송되는 데이터는 크기가 매우 제한적입니다 (2000 자)</li>
<li>데이터가 URL에 직접 보입니다 (비밀번호에 적절하지 않습니다)</li>
<li>파일 업로드는 작동하지 않습니다</li>
</ul>
<p>그러므로 아무런 제한없이 하려면, HTTP 요청 본문에서 폼 데이터를 서버로 보내는 <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.5">POST method</a>를 사용하게 변경할 수 있습니다.</p>
<blockquote>
<p>POST는 데이터를 보낼 때 가장 일반적인 방식이지만, <a href="https://www.w3.org/2001/tag/doc/whenToUseGet.html">some specific scenarios</a>에서 검색 필드를 구현할 때는, GET 방법을 사용하는 것이 더 좋습니다.</p>
</blockquote>
<h3 id="작업-1">작업</h3>
<p>가입 폼에 <code>action</code>과 <code>method</code> 속성을 추가합니다:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;registerForm&quot;</span><span class="ot"> action=</span><span class="st">&quot;//localhost:5000/api/accounts&quot;</span><span class="ot"> method=</span><span class="st">&quot;POST&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>이제 이름으로 새로운 계정을 가입합니다. <em>Register</em> 버튼을 클릭하면 다음과 같은 내용이 표시됩니다:</p>
<p><img src=".././images/form-post.png" /></p>
<p>모든 것이 잘 되면, 서버에 생성된 계정 데이터가 포함되어 <a href="https://www.json.org/json-en.html">JSON</a>으로 응답해야 합니다.</p>
<p>✅ 같은 이름으로 다시 가입해보세요. 무슨 일이 일어났나요?</p>
<h2 id="페이지를-다시-불러오지-않고-데이터-제출하기">페이지를 다시 불러오지 않고 데이터 제출하기</h2>
<p>알다시피, 사용한 접근 방식에는 약간 이슈가 있습니다: 폼을 제출할 때, 앱에서 나가면서 브라우저가 서버 URL로 리디렉션됩니다. <a href="https://en.wikipedia.org/wiki/Single-page_application">Single-page application (SPA)</a>을 만들고 있으므로, 웹 앱으로 모든 페이지를 다시 불러오지 않으려 합니다.</p>
<p>페이지를 강제로 다시 불러오지 않고 폼 데이터를 서버로 보내려면, JavaScript 코드를 사용해야 합니다. <code>&lt;form&gt;</code> 요소의 <code>action</code> 속성에 URL을 넣는 대신, <code>javascript:</code> 문자열이 앞에 붙은 JavaScript 코드를 사용하여 커스텀 작업을 할 수 있습니다. 이를 사용하면 이전에 끝낸 브라우저로 자동 수행한 일부 작업을 구현해야 합니다:</p>
<ul>
<li>폼 데이터 검색하기</li>
<li>폼 데이터를 알맞은 포맷으로 변환하고 인코딩하기</li>
<li>HTTP 요청을 생성하고 서버로 전송하기</li>
</ul>
<h3 id="작업-2">작업</h3>
<p>가입 폼 <code>action</code>을 다음으로 바꿉니다:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">&lt;form</span><span class="ot"> id=</span><span class="st">&quot;registerForm&quot;</span><span class="ot"> action=</span><span class="st">&quot;javascript:register()&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p><code>app.js</code> 열어서 <code>register</code>라고 지어진 새로운 함수를 추가합니다:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">function</span> <span class="at">register</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="kw">const</span> registerForm <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;registerForm&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="kw">const</span> formData <span class="op">=</span> <span class="kw">new</span> <span class="at">FormData</span>(registerForm)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="kw">const</span> data <span class="op">=</span> <span class="va">Object</span>.<span class="at">fromEntries</span>(formData)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5">  <span class="kw">const</span> jsonData <span class="op">=</span> <span class="va">JSON</span>.<span class="at">stringify</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="op">}</span></a></code></pre></div>
<p>여기서는 <code>getElementById()</code>를 사용하여 폼 요소를 검색하고, <a href="https://developer.mozilla.org/docs/Web/API/FormData"><code>FormData</code></a> 헬퍼를 사용하여 키/값 쌍 집합으로 폼 컨트롤에서 값을 추출합니다. 그러고 <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/fromEntries"><code>Object.fromEntries()</code></a>를 사용하여 데이터를 일반 객체로 변환하여 최종적으로 웹에서 데이터를 교환할 때, 일반적으로 사용되는 포맷인 <a href="https://www.json.org/json-en.html">JSON</a>으로 데이터를 직렬화합니다.</p>
<p>데이터는 이제 서버에 보낼 준비가 되었습니다. <code>createAccount</code>라고 지은 새로운 함수를 만듭니다:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">async</span> <span class="kw">function</span> <span class="at">createAccount</span>(account) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-3" title="3">    <span class="kw">const</span> response <span class="op">=</span> <span class="cf">await</span> <span class="at">fetch</span>(<span class="st">&#39;//localhost:5000/api/accounts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-4" title="4">      <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-5" title="5">      <span class="dt">headers</span><span class="op">:</span> <span class="op">{</span> <span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb8-6" title="6">      <span class="dt">body</span><span class="op">:</span> account</a>
<a class="sourceLine" id="cb8-7" title="7">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-8" title="8">    <span class="cf">return</span> <span class="cf">await</span> <span class="va">response</span>.<span class="at">json</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-9" title="9">  <span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-10" title="10">    <span class="cf">return</span> <span class="op">{</span> <span class="dt">error</span><span class="op">:</span> <span class="va">error</span>.<span class="at">message</span> <span class="op">||</span> <span class="st">&#39;Unknown error&#39;</span> <span class="op">};</span></a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="op">}</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="op">}</span></a></code></pre></div>
<p>이 함수는 어떤 일을 할까요? 먼저, 여기있는 <code>async</code> 키워드를 확인하세요. 이 함수는 <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function"><strong>asynchronously</strong></a>하게 실행하는 코드가 포함되어 있다는 것을 의미합니다. <code>await</code> 키워드와 함께 사용하면, 비동기 코드가 실행될 때까지 기다릴 수 있습니다 - 여기에서 서버의 응답을 기다리는 것과 같습니다 - 계속하기 전에.</p>
<p>여기는 `<code>async/await</code> 사용 방식에 대한 간단한 영상입니다:</p>
<p><a href="https://youtube.com/watch?v=YwmlRkrxvkk" title="Async and Await for managing promises"><img src="https://img.youtube.com/vi/YwmlRkrxvkk/0.jpg" alt="Async and Await for managing promises" /></a></p>
<p><code>fetch()</code> API를 사용하여 JSON 데이터를 서버로 보냅니다. 이 메소드는 2개의 파라미터가 사용됩니다:</p>
<ul>
<li>서버의 URL이므로, 여기에 <code>//localhost:5000/api/accounts</code>를 다시 넣습니다.</li>
<li>요청의 설정입니다. 여기서 메소드를 <code>POST</code>로 설정하고 요청한 <code>body</code>를 줍니다. JSON 데이터를 서버로 보낼 때, <code>Content-Type</code> 헤더를 <code>application/json</code>으로 설정하여 서버가 인터프리터하는 방식을 알 수 있도록 합니다.</li>
</ul>
<p>서버가 JSON으로 응답하므로, <code>await response.json()</code>을 사용하여 JSON 콘텐츠를 파싱하고 결과 객체를 반환할 수 있습니다. 이 메소드는 비동기이므로, 반환하기 전 여기에서 <code>await</code> 키워드를 사용하여 파싱하는 도중에도 오류가 발생하는지 확인합니다.</p>
<p>이제 <code>register</code> 함수에 코드를 추가하여 <code>createAccount()</code>를 호출합니다:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="at">createAccount</span>(jsonData)<span class="op">;</span></a></code></pre></div>
<p><code>await</code> 함수를 여기에서 사용하기 때문에, 가입 함수 전에 <code>async</code> 키워드를 추가해야 합니다:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">async</span> <span class="kw">function</span> <span class="at">register</span>() <span class="op">{</span></a></code></pre></div>
<p>마지막으로, 결과를 보기 위해서 로그를 추가하겠습니다. 최종 함수은 다음과 같습니다:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">async</span> <span class="kw">function</span> <span class="at">register</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="kw">const</span> registerForm <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;registerForm&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="kw">const</span> formData <span class="op">=</span> <span class="kw">new</span> <span class="at">FormData</span>(registerForm)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="kw">const</span> jsonData <span class="op">=</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="va">Object</span>.<span class="at">fromEntries</span>(formData))<span class="op">;</span></a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="at">createAccount</span>(jsonData)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7">  <span class="cf">if</span> (<span class="va">result</span>.<span class="at">error</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-8" title="8">    <span class="cf">return</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;An error occured:&#39;</span><span class="op">,</span> <span class="va">result</span>.<span class="at">error</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-9" title="9">  <span class="op">}</span></a>
<a class="sourceLine" id="cb11-10" title="10"></a>
<a class="sourceLine" id="cb11-11" title="11">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Account created!&#39;</span><span class="op">,</span> result)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="op">}</span></a></code></pre></div>
<p>조금 길지만 도착했습니다! <a href="https://developer.mozilla.org/docs/Learn/Common_questions/What_are_browser_developer_tools">browser developer tools</a>를 열고, 새 계정을 가입하면, 웹 페이지에 변경 사항이 표시되지 않으면서 콘솔에 작동을 확인할 메시지가 나타납니다.</p>
<figure>
<img src=".././images/browser-console.png" alt="Screenshot showing log message in the browser console" /><figcaption>Screenshot showing log message in the browser console</figcaption>
</figure>
<p>✅ 데이터가 안전하게 서버로 보내졌다고 생각하나요? 누군가 요청을 가져갈 수 있다면 어떤가요? 보안 데이터 통신에 대해 자세히 보려면 <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a>를 읽어보세요.</p>
<h2 id="data-검증하기">Data 검증하기</h2>
<p>사용자 이름을 먼저 설정하지 않고 새 계정을 가입하려하면, 서버에서 상태 코드 <a href="https://developer.mozilla.org/docs/Web/HTTP/Status/400#:~:text=The%20HyperText%20Transfer%20Protocol%20(HTTP,%2C%20or%20deceptive%20request%20routing).">400 (Bad Request)</a> 오류를 반환하는 것으로 볼 수 있습니다.</p>
<p>데이터를 서버로 보내기 전에 할 수 있다면, 유요한 요청을 보낼 수 있도록, 미리 <a href="https://developer.mozilla.org/docs/Learn/Forms/Form_validation">validate the form data</a>를 실습하는 것이 좋습니다. HTML5 포맷 컨트롤은 다양한 속성을 사용하여 빌트인 유효성 검사를 제공합니다:</p>
<ul>
<li><code>required</code>: 필드를 채워야하며 안 채운다면 폼을 제출할 수 없습니다.</li>
<li><code>minlength</code>와 <code>maxlength</code>: 텍스트 입력의 최소 및 최대 문자 수를 정의합니다.</li>
<li><code>min</code>과 <code>max</code>: 숫자 필드의 최소값과 최대값을 정의합니다.</li>
<li><code>type</code>: <code>number</code>, <code>email</code>, <code>file</code> 또는 <a href="https://developer.mozilla.org/docs/Web/HTML/Element/input">other built-in types</a>처럼, 예상되는 데이터의 종류를 정의합니다. 이 속성은 폼 컨트롤의 비주얼 렌더링을 바꿀 수도 있습니다.</li>
<li><code>pattern</code>: 입력된 데이터가 유효한지 테스트하기 위해 <a href="https://developer.mozilla.org/docs/Web/JavaScript/Guide/Regular_Expressions">regular expression</a> 패턴을 정의할 수 있습니다.</li>
</ul>
<blockquote>
<p>Tip: 유효하거나 <code>:valid</code>와 <code>:invalid</code> CSS pseudo-classes를 사용하지 않는 여부에 따라 폼 컨트롤의 모양을 커스텀할 수 있습니다.</p>
</blockquote>
<h3 id="작업-3">작업</h3>
<p>유효한 새로운 계정을 만들 때에 username과 currency라는 2개의 필수 필드가 필요하며, 다른 필드는 옵션입니다. HTML에서 폼을 갱신하여 다음 사항을 반영합니다:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;user&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> required</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb12-2" title="2">...</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;currency&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;$&quot;</span><span class="ot"> required</span><span class="kw">&gt;</span></a></code></pre></div>
<p>이 특정 서버을 구현하는 것은 필드의 최대 길이에 제한을 걸진 않지만, 항상 사용자 텍스트 항목에 대하여 적당한 제한을 두는 것이 좋습니다.</p>
<p><code>maxlength</code> 속성을 이 텍스트 필드에 추가합니다:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;user&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> maxlength=</span><span class="st">&quot;20&quot;</span><span class="ot"> required</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb13-2" title="2">...</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;currency&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> value=</span><span class="st">&quot;$&quot;</span><span class="ot"> maxlength=</span><span class="st">&quot;5&quot;</span><span class="ot"> required</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb13-4" title="4">...</a>
<a class="sourceLine" id="cb13-5" title="5"><span class="kw">&lt;input</span><span class="ot"> name=</span><span class="st">&quot;description&quot;</span><span class="ot"> type=</span><span class="st">&quot;text&quot;</span><span class="ot"> maxlength=</span><span class="st">&quot;100&quot;</span><span class="kw">&gt;</span></a></code></pre></div>
<p>이제 <em>Register</em> 버튼을 누르고 정의한 유효성 검사 규칙을 필드가 따르지 않는 경우에는, 다음과 같이 보입니다:</p>
<figure>
<img src="./images/validation-error.png" alt="Screenshot showing the validation error when trying to submit the form" /><figcaption>Screenshot showing the validation error when trying to submit the form</figcaption>
</figure>
<p>서버에 데이터를 보내기 <em>전에 하는</em> 유효성 검사를 <strong>client-side</strong> 유효성 검사라고 합니다. 그러나 데이터를 보내지 않고 모든 검사를 하는 것은 항상 가능하지 않습니다. 예를 들면, 서버에 요청을 보내지 않고 동일한 사용자 이름을 가진 계정이 이미 존재하는지 확인할 수 있는 방식은 없습니다. 서버에서 수행되는 추가적인 유효성 검사를 <strong>server-side</strong> 유효성 검사라고합니다.</p>
<p>일반적으로 모두 구현해야하며, 클라이언트-측 유효성 검사를 사용하면 사용자에게 즉시 피드백을 주고 사용자 경험도 향상되지만, 서버-측 유효성 검사도 바뀌는 사용자 데이터가 건전하고 안전한지 확인하려면 중요합니다.</p>
<hr />
<h2 id="도전">🚀 도전</h2>
<p>이미 사용자가 존재한다면 HTML 오류 메시지가 나옵니다.</p>
<p>다음은 살짝 스타일을 적용한 뒤에 최종 로그인 페이지를 보여주는 예시입니다:</p>
<figure>
<img src=".././images/result.png" alt="Screenshot of the login page after adding CSS styles" /><figcaption>Screenshot of the login page after adding CSS styles</figcaption>
</figure>
<h2 id="강의-후-퀴즈">강의 후 퀴즈</h2>
<p><a href="https://nice-beach-0fe9e9d0f.azurestaticapps.net/quiz/44?loc=ko">Post-lecture quiz</a></p>
<h2 id="리뷰-자기주도-학습">리뷰 &amp; 자기주도 학습</h2>
<p>개발자는 특히 유효성 검사 전략과 관련하여, 폼을 작성하는 노력에 대해 매우 창의적으로 생각했습니다. <a href="https://codepen.com">CodePen</a>으로 다양한 폼 흐름에 대해 알아보세요; 흥미롭고 영감이 생기는 폼을 찾을 수 있나요?</p>
<h2 id="과제">과제</h2>
<p><a href="../assignment.md">Style your bank app</a></p>
</body>
</html>
