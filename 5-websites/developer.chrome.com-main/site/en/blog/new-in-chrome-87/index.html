<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2020-11-17" />
  <title>New in Chrome 87</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">New in Chrome 87</h1>
<p class="date">2020-11-17</p>
</header>
<p>Chrome 87 is starting to roll out to stable now.</p>
<p>{% YouTube id=‘NCKMMzVn1c8’ %}</p>
<p>Here’s what you need to know:</p>
<ul>
<li><a href="#cds">Chrome Dev Summit</a> is back on December 9 &amp; 10.</li>
<li>You can now control <a href="#ptz">pan, tilt, and zoom</a> on webcams that support it.</li>
<li><a href="#rr">Range requests</a> and service workers don’t require as many workarounds.</li>
<li>The <a href="#font-access">font access API</a> starts it’s origin trial.</li>
<li>And, there’s <a href="#more">plenty more</a>.</li>
</ul>
<p>I’m <a href="https://twitter.com/petele">Pete LePage</a>, working, and shooting from home, let’s dive in and see what’s new for developers in Chrome 87!</p>
<h2 id="chrome-dev-summit-cds">Chrome Dev Summit {: #cds }</h2>
<p>{% Img src=“image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/M6GzgK34vmmwUhsymAmI.png”, alt=“Chrome Dev Summit logo”, className=“float-right”, height=“311”, width=“800” %}</p>
<p>The Chrome Dev Summit is back on December 9th and 10th with its 8th chapter. But this time, we’re coming to you. We’re bringing all the latest updates, lots of new content, and plenty of Chromies.</p>
<p>There are a ton of <a href="/devsummit/schedule/?utm_source=nic87&amp;utm_medium=website">great talks</a>, workshops, office hours, etc, and we’ll be in the YouTube chat to answer your questions. <a href="/devsummit/?utm_source=nic87&amp;utm_medium=website">Learn more</a>, and find out how you can not just watch, but participate!</p>
<h2 id="camera-pan-tilt-zoom-ptz">Camera pan, tilt, zoom {: #ptz }</h2>
<p>Most meeting rooms at Google have cameras with pan, tilt, and zoom capabilities, so that the camera can be pointed at the people in the room. But it’s not just fancy conference cameras that support PTZ - pan, tilt, zoom - many web cams support it too.</p>
<p>Starting in Chrome 87, once a user has granted permission you can now control the PTZ features on a camera.</p>
<p>Feature detection is a little different from what you’re probably used to. You’ll need to call <code>navigator.mediaDevices.getSupportedConstraints()</code> to see if the <em>browser</em> supports PTZ.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> supports <span class="op">=</span> <span class="va">navigator</span>.<span class="va">mediaDevices</span>.<span class="at">getSupportedConstraints</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="cf">if</span> (<span class="va">supports</span>.<span class="at">pan</span> <span class="op">&amp;&amp;</span> <span class="va">supports</span>.<span class="at">tilt</span> <span class="op">&amp;&amp;</span> <span class="va">supports</span>.<span class="at">zoom</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="co">// Browser supports camera PTZ.</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>{% Img src=“image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/CzXFGEZF3U05FAzXY42p.jpg”, alt=“Permission prompt for PTZ”, className=“float-right”, height=“382”, width=“800” %}</p>
<p>Then, like all other powerful APIs, the user will need to grant permission to the camera, but also to PTZ functionality.</p>
<p>To request permission for PTZ functionality, call <code>navigator.mediaDevices.getUserMedia()</code> with the PTZ constraints. This will prompt the user to grant both regular camera and camera with PTZ permissions.</p>
<p><br style="clear: both;" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="kw">const</span> opts <span class="op">=</span> <span class="op">{</span><span class="dt">video</span><span class="op">:</span> <span class="op">{</span><span class="dt">pan</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">tilt</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">zoom</span><span class="op">:</span> <span class="kw">true</span><span class="op">}};</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="kw">const</span> stream <span class="op">=</span> <span class="cf">await</span> <span class="va">navigator</span>.<span class="va">mediaDevices</span>.<span class="at">getUserMedia</span>(opts)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&quot;#video&quot;</span>).<span class="at">srcObject</span> <span class="op">=</span> stream<span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="op">}</span> <span class="cf">catch</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="co">// User denies prompt, or</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="co">// matching media is not available.</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="op">}</span></a></code></pre></div>
<p>Finally, a call to <code>MediaStreamTrack.getSettings()</code> will tell you what the <em>camera</em> supports.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> [videoTrack] <span class="op">=</span> <span class="va">stream</span>.<span class="at">getVideoTracks</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">const</span> capabilities <span class="op">=</span> <span class="va">videoTrack</span>.<span class="at">getCapabilities</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">const</span> settings <span class="op">=</span> <span class="va">videoTrack</span>.<span class="at">getSettings</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="cf">if</span> (<span class="st">&#39;pan&#39;</span> <span class="kw">in</span> settings) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="at">enablePan</span>(capabilities<span class="op">,</span> settings)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">// Similar for tilt and zoom...</span></a></code></pre></div>
<p>Once the user has granted permission, you can then call <code>videoTrack.applyConstraints()</code> to adjust the pan, tilt, and zoom.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">function</span> <span class="at">enablePan</span>(capabilities<span class="op">,</span> settings) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="kw">const</span> input <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;rangePan&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="va">input</span>.<span class="at">min</span> <span class="op">=</span> <span class="va">capabilities</span>.<span class="va">pan</span>.<span class="at">min</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="va">input</span>.<span class="at">max</span> <span class="op">=</span> <span class="va">capabilities</span>.<span class="va">pan</span>.<span class="at">max</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="va">input</span>.<span class="at">step</span> <span class="op">=</span> <span class="va">capabilities</span>.<span class="va">pan</span>.<span class="at">step</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="va">input</span>.<span class="at">value</span> <span class="op">=</span> <span class="va">settings</span>.<span class="at">pan</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="va">input</span>.<span class="at">addEventListener</span>(<span class="st">&#39;input&#39;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="kw">const</span> opts <span class="op">=</span> <span class="op">{</span> <span class="dt">advanced</span><span class="op">:</span> [<span class="op">{</span> <span class="dt">pan</span><span class="op">:</span> <span class="va">input</span>.<span class="at">value</span> <span class="op">}</span>] <span class="op">};</span></a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="cf">await</span> <span class="va">videoTrack</span>.<span class="at">applyConstraints</span>(opts)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-11" title="11">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="op">}</span></a></code></pre></div>
<p>Personally, I’m really excited about PTZ, so I can hide my messy kitchen, but you’ll have to check out the video to see that!</p>
<p>Francois has a great post <a href="https://web.dev/camera-pan-tilt-zoom/">Control camera pan, tilt, and zoom</a> on web.dev with code samples, complete details the best way to request permission, and a demo, so that you can try it out, and see if your webcam supports PTZ.</p>
<h2 id="range-requests-and-service-workers-rr">Range requests and service workers {: #rr }</h2>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests">HTTP range requests</a>, which have been available in major browsers for several years, allow servers to send requested data to the client in chunks. This is especially useful for large media files, where the user experience is improved through smoother playback, enhanced scrubbing, and better pause and resume functions.</p>
<p>Historically, range requests and services workers did not work well together, forcing developers to build work-arounds. Starting in Chrome 87, passing range requests through to the network from inside a service worker will “just work.”</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="va">self</span>.<span class="at">addEventListener</span>(<span class="st">&#39;fetch&#39;</span><span class="op">,</span> (event) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="co">// The Range: header will pass through</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="co">// in browsers that behave correctly.</span></a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="va">event</span>.<span class="at">respondWith</span>(<span class="at">fetch</span>(<span class="va">event</span>.<span class="at">request</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>For an explanation of the issues with range requests and what’s changed in Chrome 87, see Jeff’s article <a href="https://web.dev/sw-range-requests/">Handling range requests in a service worker</a> on web.dev.</p>
<h2 id="origin-trial-font-access-api-font-access">Origin Trial: Font access API {: #font-access }</h2>
<p>{% Img src=“image/0g2WvpbGRGdVs0aAPc6ObG7gkud2/x5qv7Ylxb9i2mtWkBwVt.png”, alt=“Screen shot of Photopea image editor”, className=“float-right”, height=“575”, width=“800” %}</p>
<p>Bringing design apps like Figma, Gravit Designer, and Photopea, to the web is great, and we’re seeing a lot more coming. While the web has the ability to offer a plethora of fonts, not everything is available on the web.</p>
<p>For many designers, there are some fonts installed on their computer that are critical to their work. For example, corporate logo fonts, or specialized fonts for CAD and other design applications.</p>
<p>With the font access API, which starts an origin trial in Chrome 87, a site can now enumerate the installed fonts, giving users access to all of the fonts on their system.</p>
<p><br style="clear: both;" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="co">// Query for all available fonts and log metadata.</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">const</span> fonts <span class="op">=</span> <span class="va">navigator</span>.<span class="va">fonts</span>.<span class="at">query</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="cf">for</span> <span class="cf">await</span> (<span class="kw">const</span> metadata <span class="kw">of</span> fonts) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`</span><span class="sc">${</span><span class="va">metadata</span>.<span class="at">family</span><span class="sc">}</span><span class="vs"> (</span><span class="sc">${</span><span class="va">metadata</span>.<span class="at">fullName</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="op">}</span> <span class="cf">catch</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-8" title="8">  <span class="va">console</span>.<span class="at">error</span>(err)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="op">}</span></a>
<a class="sourceLine" id="cb6-10" title="10"></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">// Roboto (Roboto Black)</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">// Roboto (Roboto Black Italic)</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">// Roboto (Roboto Bold)</span></a></code></pre></div>
<p>And sites can hook in at lower levels to get access to the font bytes, allowing them to do their own OpenType layout implementation, or perform vector filters, or transforms, on the glyph shapes.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">const</span> fonts <span class="op">=</span> <span class="va">navigator</span>.<span class="va">fonts</span>.<span class="at">query</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="cf">for</span> <span class="cf">await</span> (<span class="kw">const</span> metadata <span class="kw">of</span> fonts) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-4" title="4">    <span class="kw">const</span> sfnt <span class="op">=</span> <span class="cf">await</span> <span class="va">metadata</span>.<span class="at">blob</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5">    <span class="at">makeMagic</span>(<span class="va">metadata</span>.<span class="at">family</span><span class="op">,</span> sfnt)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="op">}</span> <span class="cf">catch</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="va">console</span>.<span class="at">error</span>(err)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="op">}</span></a></code></pre></div>
<p>Check out Tom’s article <a href="https://web.dev/local-fonts/">Use advanced typography with local fonts</a> on web.dev with all the details, and the link to the Origin Trial so you can try it yourself.</p>
<h2 id="and-more-more">And more {: #more }</h2>
<ul>
<li>Transferable Streams - <code>ReadableStream</code>, <code>WritableStream</code>, and <code>TransformStream</code> objects can now be passed as arguments to <code>postMessage()</code>.</li>
<li>We’ve implemented the most granular <code>flow-relative</code> features of the CSS Logical Properties and Values spec, including shorthands and offsets to make these logical properties and values a bit easier to write. For example, a single <code>margin-block</code> property can replace separate <code>margin-block-start</code> and <code>margin-block-end</code> rules.</li>
<li>New <code>@font-face</code> descriptors have been added to <code>ascent-override</code>, <code>descent-override</code>, and <code>line-gap-override</code> to override metrics of the font.</li>
<li>There are several new <code>text-decoration</code> and <code>underline</code> properties.</li>
<li>And there are a number of changes related to cross-origin isolation.</li>
</ul>
<h2 id="further-reading">Further reading</h2>
<p>This covers only some of the key highlights. Check the links below for additional changes in Chrome 87.</p>
<ul>
<li><a href="/blog/new-in-devtools-87">What’s new in Chrome DevTools (87)</a></li>
<li><a href="https://developers.google.com/web/updates/2020/10/chrome-87-deps-rems">Chrome 87 deprecations &amp; removals</a></li>
<li><a href="https://www.chromestatus.com/features#milestone%3D87">ChromeStatus.com updates for Chrome 87</a></li>
<li><a href="https://v8.dev/blog/v8-release-87">What’s new in JavaScript in Chrome 87</a></li>
<li><a href="https://chromium.googlesource.com/chromium/src/+log/86.0.4240.75..87.0.4280.65">Chromium source repository change list</a></li>
</ul>
<h2 id="subscribe-.hide-from-toc">Subscribe {: .hide-from-toc }</h2>
<p>Want to stay up to date with our videos, then <a href="https://goo.gl/6FP1a5">subscribe</a> to our <a href="https://www.youtube.com/user/ChromeDevelopers/">Chrome Developers YouTube channel</a>, and you’ll get an email notification whenever we launch a new video.</p>
<p>I’m Pete LePage, and as soon as Chrome 88 is released, I’ll be right here to tell you – what’s new in Chrome!</p>
</body>
</html>
