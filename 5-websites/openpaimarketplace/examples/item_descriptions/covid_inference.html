<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>covid_inference</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="covid-19-inference-service-job-template">COVID-19 Inference Service Job Template</h1>
<p>This is the inference service to visualize the prediction number of confirmed and death population in different countries.</p>
<h2 id="trained-model">Trained model</h2>
<p>The model is trained by <strong>Covid19 Prediction Model</strong>, and is stored on Azure Blob Storage.</p>
<h2 id="how-to-use">How to use</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ol type="1">
<li><p>Load model file and inference code to container</p>
<pre><code> mkdir -p /data/covid19
 cd /data/covid19
 wget &lt;% $script.uri %&gt;
 tar xvf covid_inference_project.tgz</code></pre></li>
<li><p>When use this module, you should set two environment variables:</p>
<pre><code>export CODE_DIR=/data/covid19/inference_project
export SERVER_PORT=$PAI_PORT_LIST_taskrole_0_SERVER_PORT</code></pre></li>
</ol>
<ul>
<li><p><code>CODE_DIR</code>: the service code, it will start a server at the given port.</p></li>
<li><p><code>FLASK_RUN_PORT</code>: the service port container will output.</p></li>
</ul>
<h3 id="inference-command">Inference command</h3>
<pre><code>cd ${CODE_DIR}
npm install
npm run build
npm start</code></pre>
<h2 id="how-to-check-the-result">How to check the result</h2>
<p>After job finished successfully, you could check the stdout of the job. There will be a log please go to <url> to view the result. The <url> is in the form of <code>$PAI_HOST_IP_taskrole_0:$SERVER_PORT</code>.</p>
<p>Copy the <url> to the browser to check the visualization result.</p>
</body>
</html>
